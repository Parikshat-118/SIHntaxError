<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš¦ RoadLink - Real-Time Traffic Intelligence Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
    
        :root {
            --primary: #2563eb;
            --secondary: #3b82f6;
            --accent: #10b981;
            --dark: #1e293b;
            --light: #f0f8ff;
            --light-blue-bg: #ebf5ff;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gradient: linear-gradient(135deg, var(--primary), var(--accent));
            --text-gray: #475569;
            --text-light: #e2e8f0;
            --text-muted: #64748b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        html {
            scroll-behavior: smooth;
        }

        body {
            color: var(--dark);
            background-color: var(--light);
            line-height: 1.6;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        section {
            padding: 80px 0;
        }
        
        h1, h2, h3, h4 {
            margin-bottom: 1rem;
            font-weight: 700;
            line-height: 1.2;
        }
        
        h1 { font-size: 3.5rem; }
        h2 { font-size: 2.5rem; text-align: center; margin-bottom: 3rem; }
        h3 { font-size: 1.8rem; }
        
        p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            color: var(--text-gray);
        }
        
        .btn {
            display: inline-block;
            padding: 12px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: 0 4px 14px rgba(37, 99, 235, 0.4);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(37, 99, 235, 0.6);
        }
        
        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }
        
        .btn-secondary:hover {
            background: var(--primary);
            color: white;
        }

       
        header {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            max-width: 1300px;
            margin: 0 auto;
            padding-left: 20px;
            padding-right: 20px;
            position: relative;
        }
        
        .logo {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            text-decoration: none;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 12px;
        }
        
        .logo:hover {
            background: var(--light-blue-bg);
            transform: translateY(-2px);
        }
        
        .logo i {
            margin-right: 8px;
            color: var(--accent);
            font-size: 1.8rem;
            transition: transform 0.3s ease;
        }
        
        .logo:hover i {
            transform: rotate(10deg) scale(1.1);
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            align-items: center;
            gap: 4px;
            margin: 0;
            padding: 0;
        }
        
        .nav-links li {
            position: relative;
        }
        
        .nav-links > li > a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            padding: 8px 14px;
            border-radius: 8px;
            transition: all 0.3s ease;
            position: relative;
            font-size: 0.95rem;
            white-space: nowrap;
        }
        
        .nav-links > li > a:hover {
            color: var(--primary);
            background: var(--light-blue-bg);
            transform: translateY(-1px);
        }
        
        .nav-links > li > a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 2px;
            left: 50%;
            background: var(--primary);
            transition: all 0.3s ease;
        }
        
        .nav-links > li > a:hover::after {
            width: 80%;
            left: 10%;
        }
        
        /* Auth buttons styling */
        .auth-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .auth-buttons .btn {
            padding: 10px 20px;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .auth-buttons .btn-secondary {
            background: transparent;
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .auth-buttons .btn-secondary:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .auth-buttons .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .auth-buttons .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.4);
        }

        .hamburger-menu {
            display: none;
            background: var(--light-blue-bg);
            border: 2px solid var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--primary);
            padding: 8px 10px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .hamburger-menu:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }
        
        /* Hero Map Section */
        .hero-map {
            position: relative;
            min-height: 100vh;
            padding-top: 80px;
            overflow: hidden;
        }
        
        .hero-map-container {
            position: relative;
            width: 100%;
            height: calc(100vh - 80px);
        }
        
        #hero-map {
            height: 100%;
            width: 100%;
        }
        
        .map-header-overlay {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            text-align: center;
        }
        
        .platform-intro {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px 40px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .platform-intro h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: var(--primary);
            text-shadow: none;
        }
        
        .platform-intro p {
            font-size: 1.2rem;
            margin: 0;
            color: var(--text-gray);
        }
        
        .hero-map-controls {
            position: absolute;
            top: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .map-legend {
            position: absolute;
            bottom: 30px;
            left: 30px;
            z-index: 1000;
        }
        
        .legend-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            min-width: 200px;
        }
        
        .legend-card h4 {
            margin: 0 0 15px 0;
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .legend-items {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--text-gray);
        }
        
        .dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .dot.critical { background: #dc2626; }
        .dot.high { background: #ea580c; }
        .dot.medium { background: #d97706; }
        .dot.low { background: #65a30d; }
        
        .login-prompt {
            position: absolute;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .prompt-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            min-width: 280px;
            text-align: center;
        }
        
        .prompt-card h3 {
            margin: 0 0 10px 0;
            color: var(--primary);
            font-size: 1.3rem;
        }
        
        .prompt-card p {
            margin: 0 0 20px 0;
            color: var(--text-gray);
            font-size: 0.95rem;
        }
        
        .prompt-buttons {
            display: flex;
            gap: 10px;
        }
        
        .prompt-buttons .btn {
            flex: 1;
            padding: 12px 20px;
            font-size: 0.9rem;
        }
        
        /* New Hero Section Styles */
        .hero-section-new {
            min-height: 100vh;
            position: relative;
            display: flex;
            align-items: center;
            overflow: hidden;
            background: linear-gradient(135deg, var(--primary) 0%, #1e40af 100%);
            padding-top: 80px;
        }
        
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .hero-animation {
            position: absolute;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px, 80px 80px, 100px 100px;
            animation: backgroundMove 20s ease-in-out infinite;
        }
        
        @keyframes backgroundMove {
            0%, 100% { transform: translate(0, 0); }
            33% { transform: translate(30px, -30px); }
            66% { transform: translate(-20px, 20px); }
        }
        
        .floating-icons {
            position: absolute;
            width: 100%;
            height: 100%;
        }
        
        .icon-float {
            position: absolute;
            color: rgba(255, 255, 255, 0.1);
            font-size: 2rem;
            animation: float 6s ease-in-out infinite;
        }
        
        .icon-float:nth-child(1) { top: 10%; left: 10%; animation-delay: -0.5s; }
        .icon-float:nth-child(2) { top: 20%; right: 15%; animation-delay: -2s; }
        .icon-float:nth-child(3) { top: 60%; left: 8%; animation-delay: -3.5s; }
        .icon-float:nth-child(4) { bottom: 30%; right: 10%; animation-delay: -1s; }
        .icon-float:nth-child(5) { bottom: 20%; left: 15%; animation-delay: -4s; }
        .icon-float:nth-child(6) { top: 40%; right: 8%; animation-delay: -2.5s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .hero-container {
            position: relative;
            z-index: 2;
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
            align-items: center;
        }
        
        .hero-content-main {
            color: white;
        }
        
        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .hero-badge i {
            color: #10b981;
        }
        
        .hero-title-main {
            font-size: 4rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 25px;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .highlight-text {
            background: linear-gradient(45deg, #10b981, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-description {
            font-size: 1.25rem;
            line-height: 1.7;
            margin-bottom: 40px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .hero-features-row {
            display: flex;
            gap: 15px;
            margin-bottom: 50px;
            flex-wrap: wrap;
        }
        
        .feature-highlight {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 18px;
            border-radius: 12px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .feature-highlight i {
            color: #10b981;
            font-size: 1.1rem;
        }
        
        .hero-cta {
            text-align: left;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .btn-cta-primary {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
            flex-direction: column;
            text-align: center;
            min-width: 160px;
        }
        
        .btn-cta-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.5);
        }
        
        .btn-main {
            font-size: 1rem;
            font-weight: 700;
        }
        
        .btn-sub {
            font-size: 0.8rem;
            opacity: 0.9;
            font-weight: 500;
        }
        
        .btn-cta-secondary {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 18px 30px;
            border-radius: 15px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(5px);
        }
        
        .btn-cta-secondary:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-3px);
        }
        
        .btn-cta-demo {
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 18px 30px;
            border-radius: 15px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-cta-demo:hover {
            color: white;
            border-color: rgba(255, 255, 255, 0.6);
        }
        
        .cta-benefits {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }
        
        .benefit {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .benefit i {
            color: #10b981;
        }
        
        .welcome-back-card {
            background: rgba(255, 255, 255, 0.15);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }
        
        .welcome-back-card h3 {
            margin-bottom: 15px;
            color: #10b981;
        }
        
        /* Hero Visual Section */
        .hero-visual {
            position: relative;
        }
        
        .platform-preview {
            position: relative;
        }
        
        .preview-screen {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 0;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }
        
        .screen-header {
            background: linear-gradient(45deg, #f8fafc, #e2e8f0);
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .screen-dots {
            display: flex;
            gap: 8px;
        }
        
        .dot-red, .dot-yellow, .dot-green {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
        
        .dot-red { background: #ef4444; }
        .dot-yellow { background: #f59e0b; }
        .dot-green { background: #10b981; }
        
        .screen-title {
            font-weight: 600;
            color: var(--dark);
        }
        
        .screen-content {
            padding: 25px;
            background: #f8fafc;
        }
        
        .live-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            border: 1px solid #e2e8f0;
        }
        
        .stat-box.pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
            50% { box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3); }
            100% { box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); }
        }
        
        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, var(--primary), #3b82f6);
            color: white;
            font-size: 1.2rem;
        }
        
        .stat-info {
            flex: 1;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 800;
            color: var(--dark);
            display: block;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: var(--text-gray);
            margin-top: 5px;
            display: block;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 8px;
        }
        
        .stat-trend.up {
            color: #059669;
        }
        
        .activity-feed {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .feed-header {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
        .activity-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .activity-icon.critical {
            background: #dc2626;
        }
        
        .activity-icon.critical.pulse {
            animation: criticalPulse 1.5s infinite;
        }
        
        @keyframes criticalPulse {
            0% { background: #dc2626; }
            50% { background: #ef4444; }
            100% { background: #dc2626; }
        }
        
        .activity-icon.medium {
            background: #d97706;
        }
        
        .activity-icon.low {
            background: #059669;
        }
        
        .activity-text {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .activity-title {
            font-weight: 600;
            color: var(--dark);
            font-size: 0.9rem;
        }
        
        .activity-location {
            font-size: 0.8rem;
            color: var(--text-gray);
        }
        
        .activity-time {
            font-size: 0.75rem;
            color: var(--primary);
            font-weight: 500;
        }
        
        .chat-preview {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .chat-header {
            background: linear-gradient(45deg, var(--primary), #3b82f6);
            color: white;
            padding: 12px 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .chat-messages {
            padding: 15px;
            max-height: 120px;
            overflow-y: auto;
        }
        
        .chat-message {
            margin-bottom: 8px;
            font-size: 0.85rem;
        }
        
        .chat-message:last-child {
            margin-bottom: 0;
        }
        
        .user {
            font-weight: 600;
            color: var(--primary);
        }
        
        .user.verified {
            color: #059669;
        }
        
        .user.verified::after {
            content: ' âœ“';
            color: #059669;
        }
        
        .text {
            color: var(--dark);
            margin-left: 5px;
        }
        
        .floating-stats {
            position: absolute;
            right: -20px;
            bottom: -20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
            min-width: 100px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            display: block;
        }
        
        .stat-name {
            font-size: 0.8rem;
            color: var(--text-gray);
            margin-top: 5px;
        }
        
        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.7);
            text-align: center;
            animation: bounce 2s infinite;
        }
        
        .scroll-indicator span {
            display: block;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .scroll-indicator i {
            font-size: 1.5rem;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }

        /* Problem Statement Section */
        .problem-section {
            background-color: white;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
            margin-top: 40px;
        }

        .problem-content {
            padding: 20px;
        }

        .problem-visual {
            background: var(--gradient);
            border-radius: 15px;
            padding: 40px;
            color: white;
            text-align: center;
        }

        .problem-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.2);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        /* Solution Section */
        .solution-section {
            background-color: var(--light-blue-bg);
        }

        .solution-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .solution-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
        }

        .solution-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }

        .solution-card i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        /* Map Section */
        .map-section {
            background-color: var(--light);
            padding: 100px 0;
        }
        
        .map-intro {
            text-align: center;
            max-width: 600px;
            margin: 0 auto 50px;
        }
        
        .map-intro p {
            font-size: 1.2rem;
            color: var(--text-gray);
        }
        
        .main-map-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            align-items: start;
        }
        
        .map-wrapper {
            position: relative;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            height: 600px;
        }

        #map {
            height: 100%;
            width: 100%;
            border-radius: 20px;
            z-index: 1;
        }

        .leaflet-container {
            border-radius: 20px;
        }
        
        .map-instructions {
            position: sticky;
            top: 100px;
        }
        
        .instruction-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
        }
        
        .instruction-card h4 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .instruction-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .instruction-card li {
            margin-bottom: 15px;
            font-size: 1rem;
            line-height: 1.5;
        }
        
        .login-reminder {
            margin-top: 20px;
            padding: 15px;
            background: var(--light-blue-bg);
            border-radius: 10px;
            border-left: 4px solid var(--accent);
        }
        
        .login-reminder small {
            color: var(--text-gray);
            font-weight: 500;
        }

        /* Chat Demo Section */
        .chat-section {
            background-color: var(--light-blue-bg);
        }
        
        .chatroom-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 50px;
        }
        
        .chatroom-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--primary);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .chatroom-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .chatroom-card.critical {
            border-left-color: #dc2626;
        }
        
        .chatroom-card.high {
            border-left-color: #ea580c;
        }
        
        .chatroom-card.medium {
            border-left-color: #d97706;
        }
        
        .chatroom-card.low {
            border-left-color: #65a30d;
        }
        
        .chatroom-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .chatroom-title {
            flex: 1;
        }
        
        .chatroom-title h4 {
            margin: 0 0 5px 0;
            color: var(--dark);
            font-size: 1.2rem;
        }
        
        .chatroom-subtitle {
            color: var(--text-gray);
            font-size: 0.9rem;
            margin: 0;
        }
        
        .chatroom-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .chatroom-description {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .chatroom-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .participants-count {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
            color: var(--primary);
            font-weight: 600;
        }
        
        .last-activity {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .join-chat-button {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .join-chat-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }
        
        .active-chat-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
        }
        
        .active-chat-container .chat-header {
            background: var(--gradient);
            color: white;
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-title h3 {
            margin: 0;
            font-size: 1.3rem;
        }
        
        .chat-title p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }
        
        .close-chat-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .close-chat-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .active-chat-container .chat-window {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: #f8fafc;
        }
        
        .chat-features-info {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }
        
        .chat-features-info h3 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary);
        }
        
        .features-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
        }
        
        .feature-item {
            text-align: center;
        }
        
        .feature-item i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .feature-item h4 {
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .feature-item p {
            color: var(--text-gray);
            font-size: 0.9rem;
        }
        
        /* Interactive Chat Styles */
        .chat-message {
            margin-bottom: 15px;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .chat-message.user-sent {
            margin-left: 20px;
        }
        
        .chat-message.user-sent .message-bubble {
            background: linear-gradient(45deg, var(--primary), #3b82f6);
            color: white;
            margin-left: auto;
            margin-right: 0;
            border-radius: 15px 15px 5px 15px;
        }
        
        .chat-message.helper .message-bubble {
            background: #f0fdf4;
            border-left: 4px solid #10b981;
            border-radius: 5px 15px 15px 15px;
        }
        
        .chat-message.official .message-bubble {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            border-radius: 5px 15px 15px 15px;
        }
        
        .chat-message.user .message-bubble {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 5px 15px 15px 15px;
        }
        
        .message-bubble {
            padding: 12px 15px;
            margin-top: 5px;
            max-width: 85%;
            word-wrap: break-word;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .message-sender {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--primary);
            display: flex;
            align-items: center;
        }
        
        .chat-message.user-sent .message-sender {
            justify-content: flex-end;
            color: var(--dark);
        }
        
        .chat-message.helper .message-sender {
            color: #059669;
        }
        
        .chat-message.official .message-sender {
            color: #d97706;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: white;
            border-top: 1px solid #e2e8f0;
        }
        
        .input-area input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 25px;
            outline: none;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .input-area input:focus {
            border-color: var(--primary);
        }
        
        .input-area button {
            background: var(--gradient);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        .input-area button:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }
        
        .system-message {
            background: #f0f8ff;
            border: 1px solid #b3d4fc;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .system-message p {
            margin: 0;
            font-size: 0.95rem;
        }
        
        .translate-btn {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 15px;
            padding: 4px 8px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .translate-btn:hover {
            background: #e5e7eb;
        }
        
        /* Typing Indicator */
        .typing-indicator {
            margin: 15px 0;
            opacity: 0.7;
        }
        
        .typing-message {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--text-gray);
            font-style: italic;
        }
        
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        
        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--primary);
            animation: typingDots 1.4s infinite ease-in-out;
            opacity: 0.4;
        }
        
        .typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }
        
        .typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }
        
        @keyframes typingDots {
            0%, 80%, 100% {
                opacity: 0.4;
                transform: scale(1);
            }
            40% {
                opacity: 1;
                transform: scale(1.2);
            }
        }
        
        /* Demo Message Buttons */
        .demo-msg-btn {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--primary);
        }
        
        .demo-msg-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
        }

        .chat-container {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }

        .chat-content {
            flex: 1;
        }

        .chat-features-list {
            list-style: none;
            padding-left: 0;
        }

        .chat-features-list li {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 25px;
        }

        .chat-features-list i {
            color: var(--accent);
            font-size: 1.8rem;
            margin-top: 5px;
        }

        .chat-demo-wrapper {
            flex: 1;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            max-width: 500px;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 20px;
            text-align: center;
            font-weight: 600;
        }

        .chat-header p {
            margin: 0;
            color: white;
        }

        .chat-window {
            padding: 20px;
            height: 400px;
            overflow-y: auto;
            background: #f8fafc;
        }

        .message {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
            max-width: 80%;
        }

        .message-bubble {
            padding: 12px 18px;
            border-radius: 18px;
            word-wrap: break-word;
        }

        .message-sender {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 5px;
            font-weight: 600;
        }

        .message.other {
            align-self: flex-start;
        }

        .message.other .message-bubble {
            background: #e2e8f0;
            border-bottom-left-radius: 4px;
        }

        .message.user {
            align-self: flex-end;
            align-items: flex-end;
        }

        .message.user .message-bubble {
            background: var(--secondary);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.helper .message-sender {
            color: var(--accent);
        }

        .verified-badge {
            margin-left: 5px;
            color: var(--accent);
        }

        .translate-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 0.8rem;
            cursor: pointer;
            margin-top: 8px;
            text-decoration: underline;
        }

        .image-placeholder {
            background: #cbd5e1;
            border-radius: 10px;
            padding: 20px;
            font-style: italic;
            color: var(--text-gray);
            text-align: center;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .system-message {
            background: #e0f2fe;
            border-left: 4px solid var(--secondary);
            padding: 15px;
            font-size: 0.95rem;
            border-radius: 8px;
            margin: 10px 0;
            color: #0c4a6e;
        }

        .input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid #e2e8f0;
            background: white;
        }

        #messageInput {
            flex-grow: 1;
            border: 1px solid #ccc;
            border-radius: 25px;
            padding: 12px 20px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }

        #messageInput:focus {
            border-color: var(--primary);
        }

        #sendButton {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 15px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: background-color 0.3s;
        }

        #sendButton:hover {
            background: var(--dark);
        }

        /* Features Grid */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .feature-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        /* Target Users Section */
        .users-section {
            background: var(--light);
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-top: 50px;
            text-align: center;
        }

        .user-category {
            background: white;
            padding: 40px 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }

        .user-category:hover {
            transform: translateY(-5px);
        }

        .user-category i {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        /* Impact Section */
        .impact-section {
            background: var(--gradient);
            color: white;
        }

        .impact-section h2, .impact-section h3 {
            color: white;
        }

        .impact-section p {
            color: var(--text-light);
        }

        .impact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .impact-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
        }

        .impact-card i {
            font-size: 2.5rem;
            color: white;
            margin-bottom: 20px;
        }

        .impact-card h3 {
            color: white;
        }

        .impact-card p {
            color: var(--text-light);
        }

        /* Verification Demo Section */
        .verification-section {
            background: white;
        }

        .verification-demo {
            background: var(--light-blue-bg);
            border-radius: 15px;
            padding: 40px;
            margin-top: 40px;
            text-align: center;
        }

        .verification-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .level-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .level-card.level-2 {
            border: 2px solid var(--accent);
        }

        /* Contact Section */
        .contact-section {
            background: var(--light-blue-bg);
        }

        .contact-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: flex-start;
        }

        .contact-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 60px 0 30px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-column h3 {
            margin-bottom: 20px;
            color: white;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 12px;
        }

        .footer-links a {
            color: #a7c7e7;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: white;
        }

        .social-icons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-icons a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: white;
            font-size: 1.3rem;
            transition: background 0.3s;
        }

        .social-icons a:hover {
            background: var(--primary);
        }

        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid #334155;
            color: #94a3b8;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        /* Animations */
        /* Enhanced Animation System */
        .animate-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .animate-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .animate-in:nth-child(1) { transition-delay: 0.1s; }
        .animate-in:nth-child(2) { transition-delay: 0.2s; }
        .animate-in:nth-child(3) { transition-delay: 0.3s; }
        .animate-in:nth-child(4) { transition-delay: 0.4s; }
        .animate-in:nth-child(5) { transition-delay: 0.5s; }

        /* Mobile Responsive */
        @media (max-width: 992px) {
            h1 { font-size: 2.8rem; }
            h2 { font-size: 2.2rem; }
            .chat-container { flex-direction: column; }
            .contact-grid { grid-template-columns: 1fr; }
            .main-map-container { grid-template-columns: 1fr; }
            .hero-buttons {
                flex-direction: column;
                gap: 15px;
                align-items: center;
            }
            .hero-map h1 { font-size: 3rem; }
            .demo-accounts { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .hamburger-menu { display: block; }
            h1 { font-size: 2.3rem; }
            h2 { font-size: 2rem; }
            section { padding: 60px 0; }
            .hero { min-height: 80vh; }
            .problem-stats { grid-template-columns: 1fr; }
            
            /* New Hero Section Mobile Styles */
            .hero-container {
                grid-template-columns: 1fr;
                gap: 40px;
                padding: 0 20px;
            }
            
            .hero-title-main {
                font-size: 2.5rem;
            }
            
            .hero-description {
                font-size: 1.1rem;
            }
            
            .hero-features-row {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }
            
            .feature-highlight {
                padding: 10px 14px;
                font-size: 0.8rem;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .btn-cta-primary,
            .btn-cta-secondary,
            .btn-cta-demo {
                width: 100%;
                max-width: 280px;
                justify-content: center;
            }
            
            .cta-benefits {
                justify-content: center;
                text-align: center;
            }
            
            .floating-stats {
                position: relative;
                right: 0;
                bottom: 0;
                flex-direction: row;
                justify-content: center;
                margin-top: 20px;
            }
            
            .stat-card {
                padding: 15px;
                min-width: 80px;
            }
            
            .screen-content {
                padding: 20px;
            }
            
            .live-stats {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .activity-feed {
                padding: 15px;
            }
            
            .activity-item {
                padding: 10px 0;
            }
        }

        /* Mobile Navigation */
        .mobile-nav {
            position: fixed;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(248, 250, 252, 0.98) 100%);
            backdrop-filter: blur(20px);
            z-index: 1001;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .mobile-nav.is-open {
            left: 0;
        }

        .mobile-nav .nav-links {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        .mobile-nav .nav-links li {
            margin: 0;
        }

        .mobile-nav .nav-links a {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
            text-decoration: none;
            padding: 12px 30px;
            border-radius: 12px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .mobile-nav .nav-links a:hover {
            background: var(--light-blue-bg);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .close-btn {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 2rem;
            background: var(--light-blue-bg);
            border: 2px solid var(--primary);
            cursor: pointer;
            color: var(--primary);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-btn:hover {
            background: var(--primary);
            color: white;
            transform: rotate(90deg) scale(1.1);
        }

        /* Authentication Styles */
        .auth-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .auth-buttons .btn {
            padding: 8px 20px;
            font-size: 0.9rem;
        }

        .user-dropdown {
            position: relative;
            display: inline-block;
        }

        .user-avatar {
            background: none;
            border: none;
            color: var(--dark);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 25px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .user-avatar:hover {
            background-color: var(--light-blue-bg);
            border-color: var(--primary);
            transform: translateY(-1px);
        }
        
        .user-avatar:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        .user-avatar:active {
            background-color: var(--primary);
            color: white;
            transform: translateY(0px);
        }

        .user-avatar i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .dropdown-content {
            position: absolute;
            right: 0;
            top: calc(100% + 8px);
            background-color: white;
            min-width: 220px;
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            z-index: 1001;
            padding: 8px 0;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(226, 232, 240, 0.8);
            backdrop-filter: blur(10px);
            /* Improved Windows browser compatibility */
            pointer-events: none;
        }

        .dropdown-content.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            pointer-events: auto;
        }

        .dropdown-content a {
            color: var(--dark);
            padding: 12px 20px;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95rem;
            border-radius: 8px;
            margin: 2px 8px;
        }

        .dropdown-content a:hover {
            background-color: var(--light-blue-bg);
            color: var(--primary);
            transform: translateX(4px);
            padding-left: 24px;
        }

        .dropdown-content a i {
            width: 16px;
            color: var(--primary);
        }
        
        .dropdown-header {
            padding: 16px 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-bottom: 1px solid #e2e8f0;
            border-radius: 12px 12px 0 0;
            margin: -8px -0 8px 0;
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-name {
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .user-type {
            font-size: 0.8rem;
            color: var(--text-gray);
            text-transform: capitalize;
        }
        
        .dropdown-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 0;
        }
        
        .logout-btn {
            color: #dc2626 !important;
            font-weight: 600;
            margin-top: 4px;
            border-top: 1px solid #f1f5f9;
            padding-top: 12px !important;
        }
        
        .logout-btn:hover {
            background-color: #fef2f2 !important;
            color: #dc2626 !important;
            transform: translateX(4px) !important;
            padding-left: 24px !important;
        }
        
        .logout-btn i {
            color: #dc2626 !important;
        }

        /* Authentication Modal Styles */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .auth-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .auth-modal-content {
            background: white;
            border-radius: 15px;
            max-width: 450px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .auth-modal.show .auth-modal-content {
            transform: scale(1);
        }

        .auth-modal-header {
            background: var(--gradient);
            color: white;
            padding: 25px;
            border-radius: 15px 15px 0 0;
            text-align: center;
            position: relative;
        }

        .auth-modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .auth-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s;
        }

        .auth-close:hover {
            opacity: 1;
        }

        .auth-modal-body {
            padding: 30px;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 1px solid #e2e8f0;
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            color: var(--text-muted);
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .auth-tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-form .form-group {
            margin-bottom: 20px;
        }

        .auth-form .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .auth-form .form-group input,
        .auth-form .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .auth-form .form-group input:focus,
        .auth-form .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .auth-submit {
            width: 100%;
            background: var(--gradient);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .auth-submit:hover {
            transform: translateY(-2px);
        }
        
        /* Quick Login Buttons */
        .quick-login-btn {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 90px;
            color: var(--dark);
        }
        
        .quick-login-btn:hover {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            border-color: var(--primary);
            transform: translateY(-1px);
            color: var(--primary);
        }

        /* Dashboard Styles */
        .dashboard {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--light);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            overflow-y: auto;
        }

        .dashboard.show {
            opacity: 1;
            visibility: visible;
        }

        .dashboard-header {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .dashboard-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dashboard-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .dashboard-content {
            padding: 30px 0;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .dashboard-card h4 {
            margin-bottom: 15px;
            color: var(--dark);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-value {
            font-weight: 700;
            color: var(--primary);
        }

        /* Map Enhancement Styles */
        .map-container {
            position: relative;
        }

        .map-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .map-control-btn {
            background: rgba(255, 255, 255, 0.95);
            border: none;
            color: var(--primary);
            padding: 12px 18px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 140px;
        }

        .map-control-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.3);
        }

        .map-control-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }
        
        .map-control-btn i {
            font-size: 1rem;
        }

        .incident-popup {
            max-width: 250px;
        }

        .incident-popup h4 {
            margin: 0 0 10px 0;
            color: var(--primary);
        }

        .incident-popup p {
            margin: 5px 0;
            font-size: 0.9rem;
        }

        .join-chat-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            margin-top: 10px;
            width: 100%;
        }

        .join-chat-btn:hover {
            background: #0d9469;
        }

        .report-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .report-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .report-modal-content {
            background: white;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s;
        }

        .report-modal.show .report-modal-content {
            transform: scale(1);
        }

        .report-modal-header {
            background: var(--gradient);
            color: white;
            padding: 20px 25px;
            border-radius: 15px 15px 0 0;
            position: relative;
        }

        .report-modal-header h3 {
            margin: 0;
        }

        .report-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .report-modal-body {
            padding: 25px;
        }

        @media (max-width: 992px) {
            /* Tablet and smaller desktop adjustments */
            .hero-container {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 40px;
            }
            
            .hero-visual {
                order: 1; /* Show visual after content on tablet */
            }
            
            .hero-content-main {
                order: 0; /* Show content first on tablet */
            }
            
            .live-stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .floating-stats {
                position: static;
                display: flex;
                flex-direction: row;
                justify-content: center;
                gap: 20px;
                margin-top: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .auth-buttons {
                display: none;
            }
            
            .mobile-nav .nav-links {
                position: relative;
            }
            
            .mobile-nav .auth-buttons {
                display: flex;
                flex-direction: column;
                gap: 15px;
                margin-top: 30px;
            }
            
            .map-controls {
                top: 10px;
                right: 10px;
                flex-direction: row;
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .map-control-btn {
                padding: 10px 14px;
                font-size: 0.85rem;
                white-space: nowrap;
                min-height: 44px;
            }
            
            .demo-visual {
                height: 400px;
            }
            
            .chat-demo-wrapper {
                max-width: 100%;
                margin: 0;
            }
            
            .auth-modal-content {
                margin: 15px;
                width: calc(100% - 30px);
                max-height: calc(100vh - 60px);
                overflow-y: auto;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .user-dropdown .dropdown-content {
                right: 0;
                left: auto;
                min-width: 200px;
            }
            
            /* Hero section tablet */
            .hero-container {
                display: grid;
                grid-template-columns: 1fr;
                text-align: center;
                gap: 40px;
            }
            
            .hero-content-main {
                order: 0; /* Content first on tablet */
            }
            
            .hero-visual {
                order: 1; /* Visual second on tablet */
            }
            
            .hero-title-main {
                font-size: 3rem;
            }
            
            .hero-features-row {
                grid-template-columns: 1fr 1fr;
                gap: 20px;
            }
            
            .cta-buttons {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }
            
            .btn-cta-primary,
            .btn-cta-secondary,
            .btn-cta-demo {
                width: 100%;
                max-width: 400px;
            }
            
            /* Chat section tablet */
            .chatroom-grid {
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            }
            
            .features-row {
                grid-template-columns: 1fr 1fr;
                gap: 25px;
            }
        }
        
        @media (max-width: 480px) {
            /* Hero Section Mobile */
            .hero-title-main {
                font-size: 2.5rem !important;
                line-height: 1.2;
            }
            
            .hero-description {
                font-size: 1rem !important;
                line-height: 1.6;
            }
            
            .hero-features-row {
                grid-template-columns: 1fr 1fr !important;
                gap: 15px;
            }
            
            .feature-highlight {
                font-size: 0.8rem !important;
                padding: 8px 12px;
            }
            
            /* CTA Buttons Mobile */
            .cta-buttons {
                flex-direction: column;
                gap: 12px;
            }
            
            .btn-cta-primary,
            .btn-cta-secondary,
            .btn-cta-demo {
                width: 100%;
                text-align: center;
                padding: 18px 20px;
                font-size: 1rem;
            }
            
            .btn-main {
                font-size: 1.1rem;
            }
            
            .btn-sub {
                font-size: 0.9rem;
            }
            
            /* Navigation Mobile */
            .logo {
                font-size: 1.3rem;
                padding: 6px 10px;
            }
            
            nav {
                padding-left: 15px;
                padding-right: 15px;
            }
            
            /* Map Controls Mobile */
            .map-controls {
                position: relative;
                top: 0;
                right: 0;
                margin-bottom: 15px;
                justify-content: center;
                flex-direction: row;
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .map-control-btn {
                padding: 10px 14px;
                font-size: 0.85rem;
                white-space: nowrap;
                min-width: auto;
            }
            
            .main-map-container {
                margin-top: 20px;
            }
            
            .map-wrapper {
                height: 350px;
                border-radius: 12px;
                overflow: hidden;
            }
            
            /* Chat Section Mobile */
            .chatroom-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chat-window {
                height: 280px;
            }
            
            .message-input {
                padding: 12px 15px;
                font-size: 1rem;
            }
            
            .input-area {
                padding: 15px;
                gap: 10px;
            }
            
            .input-area button {
                min-width: 44px;
                height: 44px;
            }
            
            /* Modal Mobile */
            .auth-modal-content {
                margin: 10px;
                width: calc(100% - 20px);
                max-height: calc(100vh - 40px);
                overflow-y: auto;
            }
            
            .report-modal-content {
                margin: 15px;
                width: calc(100% - 30px);
                max-height: calc(100vh - 60px);
                overflow-y: auto;
            }
            
            /* Dashboard Mobile */
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .dashboard-card {
                padding: 20px;
            }
            
            /* Forms Mobile */
            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 14px 16px;
                font-size: 1rem;
                border-radius: 8px;
            }
            
            .form-group label {
                font-size: 0.95rem;
                margin-bottom: 8px;
            }
            
            /* Stats and Cards Mobile */
            .live-stats {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .stat-box {
                padding: 15px;
            }
            
            .stat-number {
                font-size: 1.8rem;
            }
            
            /* Features Grid Mobile */
            .features-grid,
            .users-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .feature-card,
            .user-category {
                padding: 25px 20px;
            }
            
            /* Route Planner Mobile */
            .route-planner-section h2 {
                font-size: 1.8rem !important;
            }
            
            .route-planner-section h3 {
                font-size: 1.4rem !important;
            }
            
            .route-planner-section .container > div:nth-of-type(2),
            .route-planner-section .container > div:nth-of-type(3) {
                grid-template-columns: 1fr !important;
                gap: 25px !important;
            }
            
            /* Touch Improvements */
            .btn,
            .map-control-btn,
            .user-avatar,
            .nav-links a {
                min-height: 44px;
                touch-action: manipulation;
            }
            
            /* Prevent zoom on input focus */
            input[type="text"],
            input[type="email"],
            input[type="password"],
            input[type="tel"],
            select,
            textarea {
                font-size: 16px !important;
            }
            
            /* Better spacing for mobile */
            section {
                padding: 60px 0;
            }
            
            .container {
                padding: 0 15px;
            }
            
            /* Hide less important elements on small screens */
            .scroll-indicator {
                display: none;
            }
            
            /* Hero section mobile ordering */
            .hero-container {
                display: flex;
                flex-direction: column;
                text-align: center;
                padding: 0 10px;
            }
            
            .hero-content-main {
                order: 1; /* Title and content come first on mobile */
                margin-bottom: 40px;
            }
            
            .hero-visual {
                order: 2; /* Dashboard comes second on mobile */
                margin-top: 0;
            }
            
            .hero-badge {
                margin-bottom: 20px;
            }
            
            .hero-title-main {
                margin-bottom: 25px;
            }
            
            .hero-description {
                margin-bottom: 30px;
            }
            
            .hero-features-row {
                margin-bottom: 35px;
            }
            
            .preview-screen {
                padding: 0;
            }
            
            .screen-content {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav>
                <a href="#home" class="logo">
                    <i class="fas fa-traffic-light"></i>
                    RoadLink
                </a>
                <ul class="nav-links">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#map-section">Live Map</a></li>
                    <li><a href="#chat">Live Chat</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#solutions">Solutions</a></li>
                    <li><a href="route-planner.html">Route Planner</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li class="auth-buttons">
                        <a href="#" class="btn btn-secondary" id="loginBtn">
                            Login <span style="font-size: 0.8rem; opacity: 0.7;"></span>
                        </a>
                        <a href="#" class="btn btn-primary" id="signupBtn">Sign Up</a>
                    </li>
                    <li class="user-menu" id="userMenu" style="display: none;">
                        <div class="user-dropdown">
                            <button class="user-avatar" id="userAvatar">
                                <i class="fas fa-user-circle"></i>
                                <span id="userName">User</span>
                                <i class="fas fa-chevron-down" style="margin-left: 5px; font-size: 0.8rem;"></i>
                            </button>
                            <div class="dropdown-content" id="dropdownContent">
                                <div class="dropdown-header">
                                    <div class="user-info">
                                        <i class="fas fa-user-circle" style="font-size: 1.5rem; margin-right: 8px;"></i>
                                        <div>
                                            <div class="user-name" id="dropdownUserName">User Name</div>
                                            <div class="user-type" id="dropdownUserType">User Type</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="dropdown-divider"></div>
                                <a href="#" id="dashboardLink"><i class="fas fa-tachometer-alt"></i> My Dashboard</a>
                                <a href="#" id="profileLink"><i class="fas fa-user-edit"></i> Edit Profile</a>
                                <a href="#map-section"><i class="fas fa-map-marked-alt"></i> Traffic Map</a>
                                <a href="route-planner.html"><i class="fas fa-route"></i> Route Planner</a>
                                <a href="#chat"><i class="fas fa-comments"></i> Chatrooms</a>
                                <div class="dropdown-divider"></div>
                                <a href="#" id="logoutBtn" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                            </div>
                        </div>
                    </li>
                </ul>
                <button class="hamburger-menu">
                    <i class="fas fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <div class="mobile-nav">
        <button class="close-btn">&times;</button>
        <ul class="nav-links">
            <li><a href="#home">Home</a></li>
            <li><a href="#map-section">Live Map</a></li>
            <li><a href="#chat">Live Chat</a></li>
            <li><a href="#features">Features</a></li>
            <li><a href="route-planner.html">Route Planner</a></li>
            <li><a href="#contact">Contact</a></li>
            <li class="auth-buttons" id="mobileAuthButtons">
                <a href="#" class="btn btn-secondary" id="mobileLoginBtn">Login</a>
                <a href="#" class="btn btn-primary" id="mobileSignupBtn">Sign Up</a>
            </li>
            <li class="mobile-user-menu" id="mobileUserMenu" style="display: none;">
                <div style="text-align: center; padding: 20px; border-bottom: 1px solid #e2e8f0; margin-bottom: 20px;">
                    <i class="fas fa-user-circle" style="font-size: 3rem; color: var(--primary); margin-bottom: 10px;"></i>
                    <div class="mobile-user-name" id="mobileUserName" style="font-weight: 600; font-size: 1.2rem; margin-bottom: 5px;">User Name</div>
                    <div class="mobile-user-type" id="mobileUserType" style="color: var(--text-gray); font-size: 0.9rem;">User Type</div>
                </div>
                <a href="#" id="mobileDashboardLink" style="padding: 15px 0; font-size: 1.1rem;"><i class="fas fa-tachometer-alt" style="margin-right: 10px;"></i> My Dashboard</a>
                <a href="#map-section" style="padding: 15px 0; font-size: 1.1rem;"><i class="fas fa-map-marked-alt" style="margin-right: 10px;"></i> Traffic Map</a>
                <a href="route-planner.html" style="padding: 15px 0; font-size: 1.1rem;"><i class="fas fa-route" style="margin-right: 10px;"></i> Route Planner</a>
                <a href="#chat" style="padding: 15px 0; font-size: 1.1rem;"><i class="fas fa-comments" style="margin-right: 10px;"></i> Chatrooms</a>
                <div style="border-top: 1px solid #e2e8f0; margin: 20px 0;"></div>
                <a href="#" id="mobileLogoutBtn" style="padding: 15px 0; font-size: 1.1rem; color: #dc2626; font-weight: 600;"><i class="fas fa-sign-out-alt" style="margin-right: 10px; color: #dc2626;"></i> Logout</a>
            </li>
        </ul>
    </div>

    <section class="hero-section-new" id="home">
        <div class="hero-background">
            <div class="hero-animation"></div>
            <div class="floating-icons">
                <div class="icon-float"><i class="fas fa-car"></i></div>
                <div class="icon-float"><i class="fas fa-road"></i></div>
                <div class="icon-float"><i class="fas fa-comments"></i></div>
                <div class="icon-float"><i class="fas fa-map-marker-alt"></i></div>
                <div class="icon-float"><i class="fas fa-shield-alt"></i></div>
                <div class="icon-float"><i class="fas fa-mobile-alt"></i></div>
            </div>
        </div>
        
        <div class="hero-container">
            <div class="hero-content-main">
                <div class="hero-badge animate-in">
                    <i class="fas fa-shield-check"></i>
                    <span>Trusted by 50,000+ drivers â€¢ 847 active reports today</span>
                </div>
                
                <h1 class="hero-title-main animate-in">
                    RoadLink
                    <span class="highlight-text">Intelligence Network</span>
                </h1>
                
                <p class="hero-description animate-in">
                    Revolutionary AI-powered platform connecting drivers in real-time. Report incidents, 
                    join location-based chatrooms, get instant translations, and stay safe with 
                    community-driven intelligence.
                </p>
                
                <!-- Feature Highlights -->
                <div class="hero-features-row animate-in">
                    <div class="feature-highlight">
                        <i class="fas fa-bolt"></i>
                        <span>Real-time Updates</span>
                    </div>
                    <div class="feature-highlight">
                        <i class="fas fa-language"></i>
                        <span>AI Translation</span>
                    </div>
                    <div class="feature-highlight">
                        <i class="fas fa-shield-alt"></i>
                        <span>Secure & Verified</span>
                    </div>
                    <div class="feature-highlight">
                        <i class="fas fa-mobile-alt"></i>
                        <span>Mobile Ready</span>
                    </div>
                </div>
                
                <!-- CTA Buttons -->
                <div class="hero-cta animate-in" id="loginPrompt" style="display: block;">
                    <div class="cta-buttons">
                        <button class="btn-cta-primary" id="heroSignupBtn">
                            <i class="fas fa-rocket"></i>
                            <span class="btn-main">Start Your Journey</span>
                            <span class="btn-sub">Join 50K+ drivers</span>
                        </button>
                        <button class="btn-cta-secondary" onclick="showAuthModal('login')">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Login</span>
                        </button>
                        <button class="btn-cta-demo" onclick="window.location.href='#map-section'">
                            <i class="fas fa-play-circle"></i>
                            <span>View Live Demo</span>
                        </button>
                    </div>
                    <p class="cta-benefits">
                        <span class="benefit"><i class="fas fa-check-circle"></i> Free to join</span>
                        <span class="benefit"><i class="fas fa-check-circle"></i> No spam</span>
                        <span class="benefit"><i class="fas fa-check-circle"></i> Instant access</span>
                    </p>
                </div>
                
                <!-- Welcome for Logged In Users -->
                <div class="hero-cta animate-in" id="welcomeMessage" style="display: none;">
                    <div class="welcome-back-card">
                        <h3><i class="fas fa-user-check"></i> Welcome back!</h3>
                        <p>Your personalized traffic dashboard is ready</p>
                        <div class="cta-buttons">
                            <button class="btn-cta-primary" onclick="window.location.href='#map-section'">
                                <i class="fas fa-map-marked-alt"></i>
                                <span class="btn-main">Open Traffic Map</span>
                                <span class="btn-sub">View live incidents</span>
                            </button>
                            <button class="btn-cta-secondary" onclick="window.location.href='#chat'">
                                <i class="fas fa-comments"></i>
                                <span>Join Chatrooms</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Visual Preview -->
            <div class="hero-visual animate-in">
                <div class="platform-preview">
                    <div class="preview-screen">
                        <div class="screen-header">
                            <div class="screen-dots">
                                <span class="dot-red"></span>
                                <span class="dot-yellow"></span>
                                <span class="dot-green"></span>
                            </div>
                            <span class="screen-title">Live Traffic Dashboard</span>
                        </div>
                        <div class="screen-content">
                            <!-- Live Stats -->
                            <div class="live-stats">
                                <div class="stat-box pulse">
                                    <div class="stat-icon"><i class="fas fa-exclamation-triangle"></i></div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="liveIncidents">847</span>
                                        <span class="stat-label">Active Reports</span>
                                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> 12%</div>
                                    </div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-icon"><i class="fas fa-comments"></i></div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="liveChatrooms">23</span>
                                        <span class="stat-label">Live Chatrooms</span>
                                        <div class="stat-trend up"><i class="fas fa-arrow-up"></i> 8%</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Activity Feed -->
                            <div class="activity-feed">
                                <div class="feed-header">Recent Activity</div>
                                <div class="activity-item">
                                    <span class="activity-icon critical pulse"><i class="fas fa-car-crash"></i></span>
                                    <div class="activity-text">
                                        <span class="activity-title">Major accident - Highway 1</span>
                                        <span class="activity-location">Sector 29, Gurgaon</span>
                                        <span class="activity-time">2 min ago</span>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <span class="activity-icon medium"><i class="fas fa-traffic-light"></i></span>
                                    <div class="activity-text">
                                        <span class="activity-title">Heavy traffic jam</span>
                                        <span class="activity-location">Ring Road, Delhi</span>
                                        <span class="activity-time">5 min ago</span>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <span class="activity-icon low"><i class="fas fa-check-circle"></i></span>
                                    <div class="activity-text">
                                        <span class="activity-title">Construction cleared</span>
                                        <span class="activity-location">MG Road, Bangalore</span>
                                        <span class="activity-time">8 min ago</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Chat Preview -->
                            <div class="chat-preview">
                                <div class="chat-header">ðŸ’¬ Live Chat: Ring Road</div>
                                <div class="chat-messages">
                                    <div class="chat-message">
                                        <span class="user">Driver_Delhi:</span>
                                        <span class="text">Traffic moving now! ðŸ‘</span>
                                    </div>
                                    <div class="chat-message">
                                        <span class="user verified">Helper_Verified:</span>
                                        <span class="text">Accident cleared, all lanes open</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Floating Stats -->
                    <div class="floating-stats">
                        <div class="stat-card">
                            <div class="stat-value">99.9%</div>
                            <div class="stat-name">Uptime</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">2.3s</div>
                            <div class="stat-name">Response Time</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">50K+</div>
                            <div class="stat-name">Active Users</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Scroll Indicator -->
        <div class="scroll-indicator">
            <span>Discover More</span>
            <i class="fas fa-chevron-down"></i>
        </div>
    </section>


    <!-- Interactive Map Section -->
    <section class="map-section" id="map-section">
        <div class="container">
            <h2>ðŸ—ºï¸ Live Traffic Map</h2>
            <div class="map-intro">
                <p>Real-time traffic incidents with community-powered updates. Click markers to join local chatrooms and get live updates from nearby drivers.</p>
            </div>
            <div class="main-map-container">
                <div class="map-wrapper">
                    <div id="map"></div>
                    <div class="map-controls">
                        <button class="map-control-btn" id="toggleTraffic">
                            <i class="fas fa-road"></i> Traffic Layer
                        </button>
                        <button class="map-control-btn" id="reportIncident">
                            <i class="fas fa-plus-circle"></i> Report Incident
                        </button>
                        <button class="map-control-btn" id="findChatrooms">
                            <i class="fas fa-comments"></i> Active Chats
                        </button>
                    </div>
                </div>
                <div class="map-instructions">
                    <div class="instruction-card">
                        <h4>ðŸ“ How to Use the Map</h4>
                        <ul>
                            <li>ðŸ”´ <strong>View Incidents:</strong> See color-coded traffic incidents</li>
                            <li>ðŸ’¬ <strong>Join Chats:</strong> Click markers to join local chatrooms</li>
                            <li>âž• <strong>Report Issues:</strong> Click anywhere to report new incidents</li>
                            <li>ðŸ” <strong>Toggle Traffic:</strong> Show/hide traffic layer</li>
                        </ul>
                        <div class="login-reminder">
                            <small>ðŸ”’ Login required for reporting incidents and joining chats</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Chatrooms Section -->
    <section class="chat-section" id="chat">
        <div class="container">
            <h2>ðŸ’¬ Active Traffic Chatrooms</h2>
            <p style="text-align: center; max-width: 800px; margin: 0 auto 40px auto; color: var(--text-gray);">Join location-based chatrooms for real-time traffic updates. Each incident automatically creates a chatroom where nearby drivers can communicate safely.</p>
            
            <div class="chatroom-grid" id="chatroomGrid">
                <!-- Chatrooms will be populated dynamically -->
            </div>
            
            <!-- Active Chat Window -->
            <div class="active-chat-container" id="activeChatContainer" style="display: none;">
                <div class="chat-header" id="activeChatHeader">
                    <div class="chat-title">
                        <h3 id="activeChatTitle">Loading...</h3>
                        <p id="activeChatSubtitle">Loading participants...</p>
                    </div>
                    <button class="close-chat-btn" id="closeChatBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="chat-window" id="activeChatWindow">
                    <div class="system-message">
                        <p><strong>ðŸ¤– Welcome!</strong> You've joined this traffic incident chatroom. Messages are AI-moderated and can be auto-translated.</p>
                    </div>
                </div>
                
                <div class="demo-suggestions" id="demoSuggestions" style="padding: 15px; background: #f8fafc; border-top: 1px solid #e2e8f0; display: none;">
                    <small style="color: var(--text-gray); margin-bottom: 10px; display: block;">ðŸ’¡ Try these demo messages:</small>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="demo-msg-btn" onclick="insertDemoMessage('How long will this take to clear?')">â° Ask about timing</button>
                        <button class="demo-msg-btn" onclick="insertDemoMessage('Any alternate routes available?')">ðŸš— Ask for alternatives</button>
                        <button class="demo-msg-btn" onclick="insertDemoMessage('Thanks for the updates everyone!')">ðŸ™ Say thanks</button>
                        <button class="demo-msg-btn" onclick="insertDemoMessage('Traffic is moving now!')">ðŸ“¢ Share update</button>
                        <button class="demo-msg-btn" onclick="insertDemoMessage('This driver is stupid')">ðŸ¤– Test AI moderation</button>
                    </div>
                </div>
                
                <div class="input-area">
                    <input type="text" id="messageInput" placeholder="Share updates with nearby drivers...">
                    <button id="sendButton"><i class="fas fa-paper-plane"></i></button>
                    <button type="button" id="showSuggestionsBtn" style="background: #f3f4f6; color: var(--primary); width: 45px; height: 45px; border-radius: 50%; border: 1px solid #d1d5db; margin-left: 5px;" title="Show demo messages">
                        <i class="fas fa-lightbulb"></i>
                    </button>
                </div>
            </div>
            
            <!-- Chat Features Info -->
            <div class="chat-features-info">
                <h3>ðŸ›¡ï¸ Safe Communication Features</h3>
                <div class="features-row">
                    <div class="feature-item">
                        <i class="fas fa-robot"></i>
                        <h4>AI Moderation</h4>
                        <p>All messages are screened for inappropriate content</p>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-language"></i>
                        <h4>Auto Translation</h4>
                        <p>Messages automatically translate to your preferred language</p>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-user-check"></i>
                        <h4>Verified Users</h4>
                        <p>Trusted community helpers provide reliable updates</p>
                    </div>
                    <div class="feature-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <h4>Location Based</h4>
                        <p>Only drivers within 1km can join each chatroom</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Route Planner Section -->
    <section class="route-planner-section" id="route-planner" style="background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%); padding: 80px 0;">
        <div class="container">
            <div style="text-align: center; margin-bottom: 60px;">
                <h2 style="color: var(--primary); margin-bottom: 20px;">
                    ðŸ—ºï¸ AI-Powered Route Planner
                </h2>
                <p style="max-width: 700px; margin: 0 auto; font-size: 1.2rem; color: var(--text-gray);">
                    Get the smartest routes with real-time traffic analysis, incident awareness, and multiple optimization options.
                </p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 50px; align-items: center; margin-bottom: 50px;">
                <div>
                    <h3 style="color: var(--primary); margin-bottom: 25px; font-size: 1.8rem;">
                        ðŸŽ¯ Smart Navigation Features
                    </h3>
                    <div style="display: grid; gap: 20px;">
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                            <div style="background: linear-gradient(45deg, #ef4444, #f59e0b); color: white; width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                                âš¡
                            </div>
                            <div>
                                <h4 style="margin: 0; color: var(--dark);">Fastest Route</h4>
                                <p style="margin: 0; color: var(--text-gray); font-size: 0.9rem;">AI calculates quickest path considering current traffic</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                            <div style="background: linear-gradient(45deg, #2563eb, #3b82f6); color: white; width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                                ðŸ—ºï¸
                            </div>
                            <div>
                                <h4 style="margin: 0; color: var(--dark);">Shortest Distance</h4>
                                <p style="margin: 0; color: var(--text-gray); font-size: 0.9rem;">Minimize fuel consumption with optimal distance</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                            <div style="background: linear-gradient(45deg, #10b981, #059669); color: white; width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                                ðŸ›¡ï¸
                            </div>
                            <div>
                                <h4 style="margin: 0; color: var(--dark);">Safest Route</h4>
                                <p style="margin: 0; color: var(--text-gray); font-size: 0.9rem;">Well-lit roads, less accidents, safer neighborhoods</p>
                            </div>
                        </div>
                        
                        <div style="display: flex; align-items: center; gap: 15px; padding: 15px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                            <div style="background: linear-gradient(45deg, #22c55e, #16a34a); color: white; width: 50px; height: 50px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                                ðŸŒ¿
                            </div>
                            <div>
                                <h4 style="margin: 0; color: var(--dark);">Eco-Friendly</h4>
                                <p style="margin: 0; color: var(--text-gray); font-size: 0.9rem;">Reduce carbon footprint with green routing</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <div style="background: white; border-radius: 20px; padding: 30px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); border: 1px solid #e2e8f0;">
                        <div style="text-align: center; margin-bottom: 25px;">
                            <h3 style="color: var(--primary); margin-bottom: 10px;">Try Route Planning Now</h3>
                            <p style="color: var(--text-gray); margin: 0;">Experience intelligent navigation</p>
                        </div>
                        
                        <div style="display: grid; gap: 15px; margin-bottom: 25px;">
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: var(--dark);">From</label>
                                <input type="text" id="mainFromLocation" placeholder="Enter starting location" style="width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s;" onfocus="this.style.borderColor='var(--primary)'" onblur="this.style.borderColor='#e2e8f0'">
                            </div>
                            <div>
                                <label style="display: block; font-weight: 600; margin-bottom: 5px; color: var(--dark);">To</label>
                                <input type="text" id="mainToLocation" placeholder="Enter destination" style="width: 100%; padding: 12px 15px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; transition: border-color 0.3s;" onfocus="this.style.borderColor='var(--primary)'" onblur="this.style.borderColor='#e2e8f0'">
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 25px;">
                            <div style="padding: 10px 15px; border: 2px solid var(--primary); border-radius: 10px; background: var(--light-blue-bg); color: var(--primary); text-align: center; font-weight: 500;">
                                âš¡ Fastest
                            </div>
                            <div style="padding: 10px 15px; border: 2px solid #e2e8f0; border-radius: 10px; background: white; color: var(--text-gray); text-align: center; font-weight: 500;">
                                ðŸ—ºï¸ Shortest
                            </div>
                        </div>
                        
                        <button onclick="launchRouteWithLocations()" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 1.1rem; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 10px; border: none; cursor: pointer;">
                            <i class="fas fa-route"></i>
                            Launch Route Planner
                        </button>
                        
                        <div style="display: flex; justify-content: space-between; margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0; font-size: 0.9rem; color: var(--text-gray);">
                            <div style="text-align: center;">
                                <div style="font-weight: 600; color: var(--primary);">24.5 km</div>
                                <div>Distance</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: 600; color: var(--primary);">38 min</div>
                                <div>Est. Time</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-weight: 600; color: var(--primary);">â‚¹145</div>
                                <div>Fuel Cost</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; padding: 40px; background: white; border-radius: 15px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);">
                <h3 style="color: var(--primary); margin-bottom: 20px;">Why Choose Our Route Planner?</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-top: 30px;">
                    <div style="text-align: center;">
                        <div style="background: var(--light-blue-bg); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: var(--primary); font-size: 1.5rem;">
                            ðŸ“Š
                        </div>
                        <h4 style="color: var(--dark); margin-bottom: 10px;">Real-time Data</h4>
                        <p style="color: var(--text-gray); margin: 0; font-size: 0.9rem;">Live traffic updates from community reports and official sources</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="background: var(--light-blue-bg); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: var(--primary); font-size: 1.5rem;">
                            ðŸ¤–
                        </div>
                        <h4 style="color: var(--dark); margin-bottom: 10px;">AI-Powered</h4>
                        <p style="color: var(--text-gray); margin: 0; font-size: 0.9rem;">Machine learning algorithms predict traffic patterns and suggest optimal routes</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="background: var(--light-blue-bg); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; color: var(--primary); font-size: 1.5rem;">
                            ðŸ’°
                        </div>
                        <h4 style="color: var(--dark); margin-bottom: 10px;">Cost Efficient</h4>
                        <p style="color: var(--text-gray); margin: 0; font-size: 0.9rem;">Save up to 30% on fuel costs with optimized routing and traffic avoidance</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Key Features Section -->
    <section class="features-section" id="features">
        <div class="container">
            <h2>ðŸ› ï¸ Key Features That Make Us Different</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-brain"></i></div>
                    <h3>AI Jam Analysis</h3>
                    <p>Advanced AI explains <strong>why</strong> traffic exists and accurately predicts clearance times using multiple data sources.</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-map-marked-alt"></i></div>
                    <h3>Google Maps AI Integration</h3>
                    <p>Built on Google Maps with enhanced AI insights, incident detection, and smarter route suggestions.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-comments"></i></div>
                    <h3>Localized Chatrooms (1km)</h3>
                    <p>Auto-created temporary chatrooms for affected drivers. They auto-delete once traffic clears.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-exclamation-triangle"></i></div>
                    <h3>Preventive Alerts</h3>
                    <p>Warn approaching drivers before they get stuck, enabling smart route decisions in advance.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-user-shield"></i></div>
                    <h3>Verified Helper Network</h3>
                    <p>Aadhaar-authenticated community members earn verification badges for providing trusted updates.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-robot"></i></div>
                    <h3>AI Moderation & Safety</h3>
                    <p>Every message screened by AI. Inappropriate content blocked while maintaining respectful communication.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-language"></i></div>
                    <h3>Multi-Language Support</h3>
                    <p>Real-time translation enables drivers speaking different languages to communicate effectively.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
                    <h3>Secure Authentication</h3>
                    <p>Two-tier system: Phone/Email OTP for basic users, Aadhaar verification for trusted helpers.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Verification System Demo -->
    <section class="verification-section">
        <div class="container">
            <h2>ðŸ” Two-Tier Verification System</h2>
            <p style="text-align: center; max-width: 800px; margin: 0 auto;">Our security-first approach ensures trustworthy communication while protecting user privacy.</p>
            
            <div class="verification-demo">
                <h3>How User Verification Works</h3>
                <div class="verification-levels">
                    <div class="level-card">
                        <h4><i class="fas fa-user"></i> Level 1: Normal User</h4>
                        <p><strong>Requirements:</strong> Phone + Email OTP verification</p>
                        <p><strong>Can do:</strong> Join chatrooms, send messages, receive alerts</p>
                        <p><strong>Limitations:</strong> Cannot share images or be designated as "trusted source"</p>
                    </div>
                    <div class="level-card level-2">
                        <h4><i class="fas fa-user-check"></i> Level 2: Verified Helper <i class="fas fa-check-circle" style="color: var(--accent);"></i></h4>
                        <p><strong>Requirements:</strong> Aadhaar authentication + background verification</p>
                        <p><strong>Can do:</strong> Share incident photos, get verification badge, priority message display</p>
                        <p><strong>Benefits:</strong> Community trusts their updates more, helps during emergencies</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Target Users Section -->
    <section class="users-section">
        <div class="container">
            <h2>ðŸ‘¥ Built For Everyone on the Road</h2>
            <div class="users-grid">
                <div class="user-category">
                    <i class="fas fa-car"></i>
                    <h3>Daily Commuters</h3>
                    <p>Save time and reduce stress on regular routes</p>
                </div>
                <div class="user-category">
                    <i class="fas fa-road"></i>
                    <h3>Long-Distance Travelers</h3>
                    <p>Get local insights on unfamiliar routes</p>
                </div>
                <div class="user-category">
                    <i class="fas fa-truck"></i>
                    <h3>Logistics & Delivery</h3>
                    <p>Optimize delivery routes and schedules</p>
                </div>
                <div class="user-category">
                    <i class="fas fa-shield-alt"></i>
                    <h3>Local Authorities</h3>
                    <p>Get real-time ground reports for faster response</p>
                </div>
                <div class="user-category">
                    <i class="fas fa-ambulance"></i>
                    <h3>Emergency Responders</h3>
                    <p>Navigate to incidents with community assistance</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Impact Section -->
    <section class="impact-section">
        <div class="container">
            <h2>ðŸŒŸ Real-World Impact</h2>
            <p style="text-align: center; max-width: 800px; margin: 0 auto;">Our platform creates positive change for drivers, authorities, and communities through intelligent collaboration.</p>
            
            <div class="impact-grid">
                <div class="impact-card">
                    <i class="fas fa-clock"></i>
                    <h3>For Drivers</h3>
                    <p>Save 30% travel time through better route decisions and early warnings about traffic conditions.</p>
                </div>
                <div class="impact-card">
                    <i class="fas fa-tachometer-alt"></i>
                    <h3>For Authorities</h3>
                    <p>Get verified incident reports 50% faster, enabling quicker response and traffic management.</p>
                </div>
                <div class="impact-card">
                    <i class="fas fa-users"></i>
                    <h3>For Communities</h3>
                    <p>Build trust and cooperation through verified helpers and respectful communication platforms.</p>
                </div>
                <div class="impact-card">
                    <i class="fas fa-leaf"></i>
                    <h3>For Environment</h3>
                    <p>Reduce fuel consumption and emissions by 25% through optimized routing and less idling.</p>
                </div>
            </div>
        </div>
    </section>


    <!-- Contact Section -->
    <section class="contact-section" id="contact">
        <div class="container">
            <h2>ðŸ“ž Get in Touch</h2>
            <div class="contact-grid">
                <div class="contact-info">
                    <h3>Ready to Transform Traffic?</h3>
                    <p>Whether you're a city authority, logistics company, or individual driver interested in our platform, we'd love to hear from you.</p>
                    
                    <div style="margin-top: 30px;">
                        <p><i class="fas fa-envelope" style="color: var(--primary); margin-right: 10px;"></i> <strong>Email:</strong> parikshatsingh@gmail.com</p>
                        <p><i class="fas fa-phone" style="color: var(--primary); margin-right: 10px;"></i> <strong>Phone:</strong> +91 88008 17870</p>
                        <p><i class="fas fa-map-marker-alt" style="color: var(--primary); margin-right: 10px;"></i> <strong>Office:</strong> BVCOE, New Delhi, India</p>
                    </div>

                    <div style="margin-top: 30px;">
                        <h4>Partnership Opportunities:</h4>
                        <ul style="list-style: none; padding-left: 0;">
                            <li style="margin-bottom: 10px;"><i class="fas fa-handshake" style="color: var(--accent); margin-right: 10px;"></i> City Government Integration</li>
                            <li style="margin-bottom: 10px;"><i class="fas fa-building" style="color: var(--accent); margin-right: 10px;"></i> Corporate Fleet Management</li>
                            <li style="margin-bottom: 10px;"><i class="fas fa-graduation-cap" style="color: var(--accent); margin-right: 10px;"></i> Research & Development</li>
                        </ul>
                    </div>
                </div>

                <div class="contact-form">
                    <h3>Send Us a Message</h3>
                    <form id="contactForm" action="https://formspree.io/f/xwpreqao" method="POST">
                        <div class="form-group">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="organization">Organization (Optional)</label>
                            <input type="text" id="organization" name="organization">
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea id="message" name="message" required placeholder="Tell us about your interest in our platform, partnership ideas, or any questions you have..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;" id="submitBtn">
                            <span class="btn-text">Send Message</span>
                            <span class="btn-loading" style="display: none;">
                                <i class="fas fa-spinner fa-spin"></i> Sending...
                            </span>
                        </button>
                    </form>
                    
                    <!-- Success/Error Messages -->
                    <div id="formMessages" style="margin-top: 15px;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Alert Modal -->
    <div class="modal-overlay" id="alertModal">
        <div class="modal-content">
            <h3 id="modalTitle">Message Sent!</h3>
            <p id="modalMessage">Thanks for your interest! We'll get back to you within 24 hours.</p>
            <button class="btn btn-primary" id="modalClose">OK</button>
        </div>
    </div>

    <!-- Authentication Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-modal-content">
            <div class="auth-modal-header">
                <h3 id="authModalTitle">Join Our Platform</h3>
                <button class="auth-close" id="authClose">&times;</button>
            </div>
            <div class="auth-modal-body">
                <div class="auth-tabs">
                    <button class="auth-tab active" id="loginTab">Login</button>
                    <button class="auth-tab" id="signupTab">Sign Up</button>
                </div>

                <!-- Login Form -->
                <form class="auth-form active" id="loginForm">
                    <!-- Demo Credentials Info -->
                    <div style="background: #f0f9ff; border: 1px solid #0ea5e9; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 10px 0; color: #0369a1; font-size: 0.95rem;">ðŸŽ® Demo Credentials</h4>
                        <div style="font-size: 0.85rem; color: #0369a1; line-height: 1.4;">
                            <strong>Admin:</strong> admin@demo.com / admin123<br>
                            <strong>Helper:</strong> helper@demo.com / helper123<br>
                            <strong>User:</strong> user@demo.com / user123<br>
                            <em style="display: block; margin-top: 8px; font-size: 0.8rem;">Click "Quick Demo Login" for instant access!</em>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="loginEmail">Email Address</label>
                        <input type="email" id="loginEmail" required placeholder="Try: user@demo.com">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" required placeholder="Try: user123">
                    </div>
                    <div class="form-group">
                        <label for="loginUserType">Login as:</label>
                        <select id="loginUserType" required>
                            <option value="user">Regular User</option>
                            <option value="helper">Verified Helper</option>
                            <option value="admin">Administrator</option>
                        </select>
                    </div>
                    <button type="submit" class="auth-submit">Login</button>
                    
                    <!-- Quick Demo Login Buttons -->
                    <div style="margin-top: 15px; display: flex; gap: 8px; flex-wrap: wrap;">
                        <button type="button" class="quick-login-btn" data-email="user@demo.com" data-password="user123" data-type="user">
                            ðŸ‘¤ Demo User
                        </button>
                        <button type="button" class="quick-login-btn" data-email="helper@demo.com" data-password="helper123" data-type="helper">
                            âœ… Demo Helper
                        </button>
                        <button type="button" class="quick-login-btn" data-email="admin@demo.com" data-password="admin123" data-type="admin">
                            ðŸ›¡ï¸ Demo Admin
                        </button>
                    </div>
                </form>

                <!-- Signup Form -->
                <form class="auth-form" id="signupForm">
                    <div class="form-group">
                        <label for="signupName">Full Name</label>
                        <input type="text" id="signupName" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email Address</label>
                        <input type="email" id="signupEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPhone">Phone Number</label>
                        <input type="tel" id="signupPhone" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="signupUserType">Account Type:</label>
                        <select id="signupUserType" required>
                            <option value="user">Regular User (Phone/Email OTP)</option>
                            <option value="helper">Verified Helper (DigiLocker Verification)</option>
                            <option value="admin">Administrator (Invitation Only)</option>
                        </select>
                    </div>
                    <button type="submit" class="auth-submit">Create Account</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard" id="dashboard">
        <div class="dashboard-header">
            <div class="container">
                <div class="dashboard-nav">
                    <div class="dashboard-title" id="dashboardTitle">User Dashboard</div>
                    <button class="btn btn-secondary" id="closeDashboard">Back to Platform</button>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="dashboard-content" id="dashboardContent">
                <!-- Dashboard content will be dynamically loaded -->
            </div>
        </div>
    </div>

    <!-- Report Incident Modal -->
    <div class="report-modal" id="reportModal">
        <div class="report-modal-content">
            <div class="report-modal-header">
                <h3>Report Traffic Incident</h3>
                <button class="report-close" id="reportClose">&times;</button>
            </div>
            <div class="report-modal-body">
                <form id="reportForm">
                    <div class="form-group">
                        <label for="incidentType">Incident Type</label>
                        <select id="incidentType" required>
                            <option value="">Select incident type...</option>
                            <option value="accident">Vehicle Accident</option>
                            <option value="breakdown">Vehicle Breakdown</option>
                            <option value="construction">Road Construction</option>
                            <option value="flooding">Flooding/Water</option>
                            <option value="vip">VIP Movement</option>
                            <option value="protest">Protest/Gathering</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="incidentSeverity">Severity Level</label>
                        <select id="incidentSeverity" required>
                            <option value="low">Low - Minor delays</option>
                            <option value="medium">Medium - Significant delays</option>
                            <option value="high">High - Major blockage</option>
                            <option value="critical">Critical - Emergency situation</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="incidentDescription">Description</label>
                        <textarea id="incidentDescription" required placeholder="Provide details about the incident..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="incidentLocation">Location Details</label>
                        <input type="text" id="incidentLocation" required placeholder="Exact location or landmark">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Submit Report</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>ðŸš¦ Smart Traffic Platform</h3>
                    <p style="color: #a7c7e7;">Transforming how the world understands and navigates traffic through AI and community collaboration.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Platform</h3>
                    <ul class="footer-links">
                        <li><a href="#features">Features</a></li>
                        <li><a href="#demo">Live Demo</a></li>
                        <li><a href="#solution">How It Works</a></li>
                        <li><a href="#">API Documentation</a></li>
                        <li><a href="#">Mobile Apps</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>For Authorities</h3>
                    <ul class="footer-links">
                        <li><a href="#">Government Dashboard</a></li>
                        <li><a href="#">Emergency Integration</a></li>
                        <li><a href="#">Data Analytics</a></li>
                        <li><a href="#">Partnership Program</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="#">User Guide</a></li>
                        <li><a href="#">Safety Guidelines</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#contact">Support</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Smart Traffic & Safety Communication Platform. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Leaflet JavaScript for Interactive Maps -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Socket.IO Client for Real-time Communication -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <script>
        // Global variables for the application
        let map;
        let heroMap;
        let trafficLayer;
        let incidents = [];
        let currentUser = null;
        let authToken = null;
        let socket = null;
        
        // Hero Section Animations
        function initializeHeroAnimations() {
            // Animate elements on scroll
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            });
            
            document.querySelectorAll('.animate-in').forEach(el => {
                observer.observe(el);
            });
            
            // Update live statistics with realistic changes
            updateLiveStats();
            setInterval(updateLiveStats, 30000); // Update every 30 seconds
        }
        
        function updateLiveStats() {
            const incidentCountEl = document.getElementById('liveIncidents');
            const chatroomCountEl = document.getElementById('liveChatrooms');
            
            if (incidentCountEl && chatroomCountEl) {
                // Simulate realistic fluctuations
                const currentIncidents = parseInt(incidentCountEl.textContent);
                const currentChatrooms = parseInt(chatroomCountEl.textContent);
                
                // Random changes within realistic bounds
                const incidentChange = Math.floor(Math.random() * 10) - 5; // -5 to +5
                const chatroomChange = Math.floor(Math.random() * 6) - 3; // -3 to +3
                
                const newIncidents = Math.max(800, Math.min(900, currentIncidents + incidentChange));
                const newChatrooms = Math.max(18, Math.min(28, currentChatrooms + chatroomChange));
                
                // Animate number changes
                animateNumber(incidentCountEl, currentIncidents, newIncidents);
                animateNumber(chatroomCountEl, currentChatrooms, newChatrooms);
            }
        }
        
        function animateNumber(element, start, end) {
            const duration = 2000; // 2 seconds
            const steps = 30;
            const stepValue = (end - start) / steps;
            const stepTime = duration / steps;
            let currentStep = 0;
            
            const timer = setInterval(() => {
                currentStep++;
                const currentValue = Math.round(start + (stepValue * currentStep));
                element.textContent = currentValue;
                
                if (currentStep >= steps) {
                    clearInterval(timer);
                    element.textContent = end;
                }
            }, stepTime);
        }
        
        // Connect Hero Section Buttons
        function connectHeroButtons() {
            const heroSignupBtn = document.getElementById('heroSignupBtn');
            
            if (heroSignupBtn) {
                heroSignupBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showAuthModal('signup');
                });
            }
        }
        
        // Enhanced post-login experience
        function showPostLoginExperience() {
            // Hide login prompt, show welcome message
            const loginPrompt = document.getElementById('loginPrompt');
            const welcomeMessage = document.getElementById('welcomeMessage');
            
            if (loginPrompt) loginPrompt.style.display = 'none';
            if (welcomeMessage) welcomeMessage.style.display = 'block';
            
            // Show personalized features
            setTimeout(() => {
                showModal('ðŸŽ‰ Welcome to Smart Traffic Platform!', 
                    `Hi ${currentUser.name}! You now have access to:\n\n` +
                    'ðŸ—ºï¸ Interactive traffic map with live incidents\n' +
                    'ðŸ’¬ Join local chatrooms for real-time updates\n' +
                    'ðŸ“Š Personal dashboard and incident reporting\n' +
                    'ðŸš¨ Emergency alerts and notifications\n\n' +
                    'Click "Open Traffic Map" to get started!'
                );
            }, 1000);
        }
        
        // Chatroom Grid Management
        function initializeChatroomGrid() {
            loadIncidents().then(() => {
                populateChatroomGrid();
            });
        }
        
        function populateChatroomGrid() {
            const chatroomGrid = document.getElementById('chatroomGrid');
            if (!chatroomGrid) return;
            
            // Filter incidents that have active chatrooms
            const activeChatrooms = incidents.filter(incident => incident.chatRoomActive);
            
            if (activeChatrooms.length === 0) {
                chatroomGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: var(--text-gray);">
                        <i class="fas fa-comments" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3>No Active Chatrooms</h3>
                        <p>No traffic incidents with active chatrooms at the moment. Check back soon or report an incident to start a chatroom!</p>
                    </div>
                `;
                return;
            }
            
            chatroomGrid.innerHTML = activeChatrooms.map(incident => {
                const participantCount = Math.floor(Math.random() * 20) + 5; // Random 5-25 participants
                const lastActivity = getRandomTimeAgo();
                const severityClass = incident.severity;
                const severityIcon = getSeverityIcon(incident.severity);
                
                return `
                    <div class="chatroom-card ${severityClass}" onclick="joinChatroomFromGrid(${incident.id})">
                        <div class="chatroom-header">
                            <div class="chatroom-title">
                                <h4>${severityIcon} ${incident.type.toUpperCase()} - ${incident.location}</h4>
                                <p class="chatroom-subtitle">${incident.severity.toUpperCase()} Priority</p>
                            </div>
                            <div class="chatroom-status">
                                <span class="status-dot"></span>
                                <span>LIVE</span>
                            </div>
                        </div>
                        
                        <div class="chatroom-description">
                            ${incident.description}
                        </div>
                        
                        <div class="chatroom-meta">
                            <div class="participants-count">
                                <i class="fas fa-users"></i>
                                <span>${participantCount} active</span>
                            </div>
                            <div class="last-activity">
                                Last message ${lastActivity}
                            </div>
                        </div>
                        
                        <button class="join-chat-button" onclick="event.stopPropagation(); joinChatroomFromGrid(${incident.id})">
                            <i class="fas fa-sign-in-alt"></i>
                            Join Conversation
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        function getSeverityIcon(severity) {
            switch(severity) {
                case 'critical': return 'ðŸš¨';
                case 'high': return 'âš ï¸';
                case 'medium': return 'ðŸŸ¡';
                case 'low': return 'ðŸŸ¢';
                default: return 'ðŸ“';
            }
        }
        
        function getRandomTimeAgo() {
            const options = ['2 min ago', '5 min ago', '8 min ago', '12 min ago', '1 min ago', '3 min ago', '15 min ago'];
            return options[Math.floor(Math.random() * options.length)];
        }
        
        function joinChatroomFromGrid(incidentId) {
            if (!currentUser) {
                showModal('Login Required ðŸ”’', 'Please login to join traffic chatrooms and communicate with other drivers.');
                showAuthModal('login');
                return;
            }
            
            const incident = incidents.find(i => i.id === incidentId);
            if (!incident) return;
            
            // Show active chat container
            const activeChatContainer = document.getElementById('activeChatContainer');
            const activeChatTitle = document.getElementById('activeChatTitle');
            const activeChatSubtitle = document.getElementById('activeChatSubtitle');
            const activeChatWindow = document.getElementById('activeChatWindow');
            
            activeChatContainer.style.display = 'block';
            activeChatTitle.textContent = `${getSeverityIcon(incident.severity)} ${incident.type.toUpperCase()} - ${incident.location}`;
            activeChatSubtitle.textContent = `${Math.floor(Math.random() * 20) + 5} drivers participating â€¢ ${incident.severity} priority`;
            
            // Load sample messages for this chatroom
            loadChatroomMessages(incidentId);
            
            // Scroll to chat
            setTimeout(() => {
                activeChatContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
            
            // Initialize close button
            document.getElementById('closeChatBtn').onclick = () => {
                activeChatContainer.style.display = 'none';
            };
            
            // Initialize chat input functionality
            initializeChatInput(incidentId);
        }
        
        function loadChatroomMessages(incidentId) {
            const activeChatWindow = document.getElementById('activeChatWindow');
            
            // Sample messages based on incident type and severity
            const sampleMessages = getChatroomMessages(incidentId);
            
            activeChatWindow.innerHTML = `
                <div class="system-message">
                    <p><strong>ðŸ¤– AI Traffic Assistant:</strong> Welcome to this incident chatroom! You can now communicate with nearby drivers. All messages are AI-moderated for safety.</p>
                </div>
                ${sampleMessages.map(msg => `
                    <div class="chat-message ${msg.type}">
                        <div class="message-sender">${msg.sender} ${msg.verified ? '<i class="fas fa-check-circle" style="color: #10b981;"></i>' : ''} <span style="color: #94a3b8; font-weight: normal;">${msg.timestamp}</span></div>
                        <div class="message-bubble">
                            <span>${msg.text}</span>
                            ${msg.translatable ? '<button class="translate-btn">ðŸŒ Translate</button>' : ''}
                        </div>
                    </div>
                `).join('')}
            `;
            
            activeChatWindow.scrollTop = activeChatWindow.scrollHeight;
        }
        
        function getChatroomMessages(incidentId) {
            const incident = incidents.find(i => i.id === incidentId);
            if (!incident) return [];
            
            // Different sample messages based on incident type
            const messageTemplates = {
                'accident': [
                    { sender: 'TrafficHelper_Delhi', text: 'I can see the accident clearly. Two lanes are blocked, emergency services arrived.', type: 'helper', verified: true, timestamp: '3 min ago' },
                    { sender: 'Driver_Kumar', text: 'How long will this take to clear? I\'m stuck for 20 minutes already.', type: 'user', timestamp: '2 min ago' },
                    { sender: 'Emergency_Response', text: 'Accident victims being transferred to hospital. Please keep emergency lane clear.', type: 'official', verified: true, timestamp: '1 min ago' }
                ],
                'construction': [
                    { sender: 'LocalHelper', text: 'Construction work will continue till 6 PM today. Use alternate route recommended.', type: 'helper', verified: true, timestamp: '5 min ago' },
                    { sender: 'Commuter_Daily', text: 'Metro is faster option during these hours. Construction causing major delays.', type: 'user', timestamp: '4 min ago' }
                ],
                'flooding': [
                    { sender: 'Area_Resident', text: 'à¤ªà¤¾à¤¨à¥€ à¤¬à¤¹à¥à¤¤ à¤¤à¥‡à¤œà¥€ à¤¸à¥‡ à¤¬à¤¢à¤¼ à¤°à¤¹à¤¾ à¤¹à¥ˆ! à¤¬à¤šà¤•à¤° à¤œà¤¾à¤à¤‚à¥¤', type: 'user', translatable: true, timestamp: '6 min ago' },
                    { sender: 'Municipality_Team', text: 'Water pumping operations started. Road should be clear in 30-45 minutes.', type: 'official', verified: true, timestamp: '3 min ago' },
                    { sender: 'Taxi_Driver', text: 'Water level knee-deep near market area. Cars getting stuck, avoid completely.', type: 'user', timestamp: '2 min ago' }
                ],
                'breakdown': [
                    { sender: 'Mechanic_Help', text: 'Vehicle being towed away in 10 minutes. Traffic will resume normally soon.', type: 'helper', verified: true, timestamp: '4 min ago' },
                    { sender: 'DriverBehind', text: 'Thanks for the update! Can see the tow truck arriving now.', type: 'user', timestamp: '2 min ago' }
                ],
                'protest': [
                    { sender: 'TrafficPolice', text: 'Peaceful march proceeding as planned. Side roads are open for traffic.', type: 'official', verified: true, timestamp: '8 min ago' },
                    { sender: 'Local_Guide', text: 'Use Janpath route instead. It\'s moving smoothly with no delays.', type: 'helper', verified: true, timestamp: '5 min ago' }
                ]
            };
            
            return messageTemplates[incident.type] || [
                { sender: 'SystemBot', text: 'This is an active chatroom for the current traffic situation. Share updates safely!', type: 'system', timestamp: '5 min ago' }
            ];
        }
        
        // Interactive Chat Input Management
        let currentChatIncidentId = null;
        
        function initializeChatInput(incidentId) {
            currentChatIncidentId = incidentId;
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            
            // Clear any existing listeners
            sendButton.replaceWith(sendButton.cloneNode(true));
            const newSendButton = document.getElementById('sendButton');
            
            // Add click listener for send button
            newSendButton.addEventListener('click', () => sendChatMessage());
            
            // Add enter key listener
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendChatMessage();
                }
            });
            
            // Focus on input
            messageInput.focus();
            
            // Initialize suggestions button
            const showSuggestionsBtn = document.getElementById('showSuggestionsBtn');
            const demoSuggestions = document.getElementById('demoSuggestions');
            
            if (showSuggestionsBtn && demoSuggestions) {
                showSuggestionsBtn.onclick = () => {
                    demoSuggestions.style.display = 
                        demoSuggestions.style.display === 'none' ? 'block' : 'none';
                };
            }
            
            // Fix chat summary pinning - ensure it doesn't stick when typing
            const chatSummary = document.querySelector('.chat-summary');
            if (chatSummary) {
                messageInput.addEventListener('input', () => {
                    // Un-pin chat summary when user starts typing
                    chatSummary.style.position = 'static';
                    chatSummary.style.top = 'auto';
                    chatSummary.style.zIndex = 'auto';
                });
                
                messageInput.addEventListener('focus', () => {
                    // Un-pin chat summary when chat input is focused
                    chatSummary.style.position = 'static';
                    chatSummary.style.top = 'auto';
                    chatSummary.style.zIndex = 'auto';
                });
            }
        }
        
        function sendChatMessage() {
            const messageInput = document.getElementById('messageInput');
            const messageText = messageInput.value.trim();
            
            if (!messageText) return;
            
            if (!currentUser) {
                showModal('Login Required ðŸ”’', 'Please login to send messages in chatrooms.');
                return;
            }
            
            // Check for inappropriate content (AI Moderation Demo)
            const inappropriateWords = ['idiot', 'stupid', 'fool', 'moron', 'dumb', 'hate'];
            const hasInappropriateContent = inappropriateWords.some(word => 
                messageText.toLowerCase().includes(word.toLowerCase())
            );
            
            if (hasInappropriateContent) {
                showModal('Message Blocked by AI ðŸ¤–', 
                    'Your message contains inappropriate language and was not sent. Our AI promotes respectful communication in traffic situations. Please rephrase your message.');
                return;
            }
            
            // Create user message
            const userMessage = {
                sender: currentUser.name,
                text: messageText,
                type: 'user-sent',
                timestamp: new Date().toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                }),
                verified: currentUser.type === 'helper' || currentUser.type === 'admin'
            };
            
            // Add message to chat window
            addMessageToActiveChat(userMessage);
            
            // Clear input
            messageInput.value = '';
            
            // Show typing indicator and simulate responses
            showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator();
                simulateResponse(currentChatIncidentId, messageText);
            }, 2000 + Math.random() * 3000); // 2-5 seconds delay
        }
        
        function addMessageToActiveChat(message) {
            const activeChatWindow = document.getElementById('activeChatWindow');
            if (!activeChatWindow) return;
            
            const messageEl = document.createElement('div');
            messageEl.className = `chat-message ${message.type}`;
            
            const verifiedBadge = message.verified ? 
                '<i class="fas fa-check-circle" style="color: #10b981; margin-left: 5px;"></i>' : '';
            
            messageEl.innerHTML = `
                <div class="message-sender">
                    ${message.sender} ${verifiedBadge}
                    <span style="color: #94a3b8; font-weight: normal; margin-left: 10px;">${message.timestamp}</span>
                </div>
                <div class="message-bubble">
                    <span>${message.text}</span>
                    ${message.translatable ? '<button class="translate-btn">ðŸŒ Translate</button>' : ''}
                </div>
            `;
            
            // Add typing effect for sent messages
            if (message.type === 'user-sent') {
                messageEl.style.opacity = '0';
                messageEl.style.transform = 'translateY(20px)';
                activeChatWindow.appendChild(messageEl);
                
                // Animate in
                setTimeout(() => {
                    messageEl.style.transition = 'all 0.3s ease';
                    messageEl.style.opacity = '1';
                    messageEl.style.transform = 'translateY(0)';
                }, 100);
            } else {
                activeChatWindow.appendChild(messageEl);
            }
            
            // Scroll to bottom
            activeChatWindow.scrollTop = activeChatWindow.scrollHeight;
        }
        
        function simulateResponse(incidentId, userMessage) {
            const incident = incidents.find(i => i.id === incidentId);
            if (!incident) return;
            
            // Generate contextual responses based on user message and incident type
            const responses = getContextualResponses(incident, userMessage);
            
            if (responses.length > 0) {
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                addMessageToActiveChat(randomResponse);
                
                // Sometimes add a second response
                if (Math.random() < 0.3) {
                    setTimeout(() => {
                        const secondResponse = responses[Math.floor(Math.random() * responses.length)];
                        if (secondResponse !== randomResponse) {
                            addMessageToActiveChat(secondResponse);
                        }
                    }, 3000 + Math.random() * 2000);
                }
            }
        }
        
        function getContextualResponses(incident, userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Base responses for different message types
            if (lowerMessage.includes('how long') || lowerMessage.includes('when') || lowerMessage.includes('time')) {
                return [
                    {
                        sender: 'LocalHelper',
                        text: `Based on similar incidents, this usually takes 15-30 minutes to clear.`,
                        type: 'helper',
                        verified: true,
                        timestamp: 'just now'
                    },
                    {
                        sender: 'TrafficExpert',
                        text: `I've been monitoring this area. Expect another 20 minutes based on current progress.`,
                        type: 'helper',
                        verified: true,
                        timestamp: 'just now'
                    }
                ];
            }
            
            if (lowerMessage.includes('alternate') || lowerMessage.includes('route') || lowerMessage.includes('way')) {
                return [
                    {
                        sender: 'LocalDriver',
                        text: `I took the ring road bypass, saved me 15 minutes!`,
                        type: 'user',
                        verified: false,
                        timestamp: 'just now'
                    },
                    {
                        sender: 'NavigationHelper',
                        text: `Metro is your best option right now. Road traffic is completely jammed.`,
                        type: 'helper',
                        verified: true,
                        timestamp: 'just now'
                    }
                ];
            }
            
            if (lowerMessage.includes('thanks') || lowerMessage.includes('thank')) {
                return [
                    {
                        sender: 'CommunityMember',
                        text: `You're welcome! Stay safe out there ðŸš—`,
                        type: 'user',
                        verified: false,
                        timestamp: 'just now'
                    }
                ];
            }
            
            // Incident-specific responses
            const incidentResponses = {
                'accident': [
                    {
                        sender: 'Emergency_Responder',
                        text: `Emergency services are working to clear the scene. Please maintain safe distance.`,
                        type: 'official',
                        verified: true,
                        timestamp: 'just now'
                    },
                    {
                        sender: 'EyewitnessDriver',
                        text: `I can see tow trucks arriving. Should be clear soon.`,
                        type: 'user',
                        verified: false,
                        timestamp: 'just now'
                    }
                ],
                'flooding': [
                    {
                        sender: 'Area_Resident',
                        text: `Water level is still rising. Please avoid this area completely.`,
                        type: 'user',
                        verified: false,
                        timestamp: 'just now'
                    },
                    {
                        sender: 'MunicipalityTeam',
                        text: `Pumps are operational. Water should recede in 30-45 minutes.`,
                        type: 'official',
                        verified: true,
                        timestamp: 'just now'
                    }
                ],
                'construction': [
                    {
                        sender: 'RoadAuthority',
                        text: `Construction will continue till evening. Use alternate routes.`,
                        type: 'official',
                        verified: true,
                        timestamp: 'just now'
                    }
                ],
                'breakdown': [
                    {
                        sender: 'MechanicHelper',
                        text: `Vehicle is being towed now. Traffic should resume in 5-10 minutes.`,
                        type: 'helper',
                        verified: true,
                        timestamp: 'just now'
                    }
                ]
            };
            
            // Return incident-specific responses or generic ones
            return incidentResponses[incident.type] || [
                {
                    sender: 'CommunityMember',
                    text: `Thanks for the update! This helps everyone plan better.`,
                    type: 'user',
                    verified: false,
                    timestamp: 'just now'
                },
                {
                    sender: 'LocalHelper',
                    text: `Stay safe and keep sharing updates with the community!`,
                    type: 'helper',
                    verified: true,
                    timestamp: 'just now'
                }
            ];
        }
        
        // Typing Indicator
        function showTypingIndicator() {
            const activeChatWindow = document.getElementById('activeChatWindow');
            if (!activeChatWindow) return;
            
            // Remove existing typing indicator
            const existingIndicator = document.getElementById('typingIndicator');
            if (existingIndicator) existingIndicator.remove();
            
            const typingEl = document.createElement('div');
            typingEl.id = 'typingIndicator';
            typingEl.className = 'typing-indicator';
            typingEl.innerHTML = `
                <div class="typing-message">
                    <span class="typing-user">Someone is typing</span>
                    <div class="typing-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            
            activeChatWindow.appendChild(typingEl);
            activeChatWindow.scrollTop = activeChatWindow.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        // Demo Message Suggestions
        function insertDemoMessage(message) {
            const messageInput = document.getElementById('messageInput');
            const demoSuggestions = document.getElementById('demoSuggestions');
            
            if (messageInput) {
                messageInput.value = message;
                messageInput.focus();
            }
            
            if (demoSuggestions) {
                demoSuggestions.style.display = 'none';
            }
        }
        
        // API Base URL - change this if deploying to different server
        const API_BASE_URL = window.location.origin;
        
        // Initialize Socket.IO connection
        function initializeSocket() {
            socket = io(API_BASE_URL);
            
            socket.on('connect', () => {
                console.log('Connected to server via WebSocket');
            });
            
            socket.on('new-incident', (incident) => {
                incidents.push(incident);
                if (map) {
                    addIncidentToMap(incident);
                }
                showModal('New Incident Reported! ðŸš¨', 
                    `${incident.type.toUpperCase()} reported at ${incident.location}. Check the map for details.`);
            });
            
            socket.on('new-message', (data) => {
                // Handle real-time chat messages if chat window is open
                displayRealTimeMessage(data);
            });
            
            socket.on('disconnect', () => {
                console.log('Disconnected from server');
            });
        }
        
        // API Helper functions
        async function apiRequest(endpoint, options = {}) {
            const url = `${API_BASE_URL}/api${endpoint}`;
            const config = {
                headers: {
                    'Content-Type': 'application/json',
                    ...(authToken && { 'Authorization': `Bearer ${authToken}` })
                },
                ...options
            };
            
            try {
                const response = await fetch(url, config);
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'API request failed');
                }
                
                return data;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
        
        // Load incidents from backend
        async function loadIncidents() {
            try {
                const data = await apiRequest('/incidents');
                incidents = data;
                console.log('Loaded incidents from backend:', incidents.length);
            } catch (error) {
                console.error('Failed to load incidents:', error);
                // Fallback to demo data if backend is unavailable
                incidents = [
                    {
                        id: 1,
                        lat: 28.6139,
                        lng: 77.2090,
                        type: 'accident',
                        severity: 'high',
                        description: 'Major accident involving truck and two cars',
                        location: 'Ring Road - Lajpat Nagar',
                        reportedBy: 'Priya Sharma',
                        timestamp: '2:45 PM',
                        chatRoomActive: true
                    },
                    {
                        id: 2,
                        lat: 28.6304,
                        lng: 77.2177,
                        type: 'construction',
                        severity: 'medium',
                        description: 'Road repair work in progress',
                        location: 'CP - Connaught Place',
                        reportedBy: 'Traffic Authority',
                        timestamp: '10:00 AM',
                        chatRoomActive: false
                    },
                    {
                        id: 3,
                        lat: 28.5355,
                        lng: 77.3910,
                        type: 'breakdown',
                        severity: 'low',
                        description: 'Vehicle breakdown blocking one lane',
                        location: 'Noida Expressway',
                        reportedBy: 'Amit Kumar',
                        timestamp: '3:15 PM',
                        chatRoomActive: true
                    }
                ];
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // --- INITIALIZE SOCKET.IO CONNECTION ---
            initializeSocket();
            
            // --- INITIALIZE HERO ANIMATIONS ---
            initializeHeroAnimations();
            
            // --- INITIALIZE AUTHENTICATION FIRST ---
            initializeAuth();
            
            // --- CONNECT HERO BUTTONS ---
            connectHeroButtons();
            
            // --- INITIALIZE HERO MAP ---
            initializeHeroMap();
            
            // --- INITIALIZE CHATROOM GRID ---
            initializeChatroomGrid();
            
            
            // --- CHAT DEMO FUNCTIONALITY ---
            const chatWindow = document.getElementById('chatWindow');
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');

            // AI Moderation - inappropriate words that get blocked
            const inappropriateWords = ['idiot', 'stupid', 'fool', 'moron', 'dumb'];
            
            // Translation demo data
            const translations = {
                "à¤¯à¤¹à¤¾à¤ à¤¬à¤¹à¥à¤¤ à¤œà¤¾à¤® à¤¹à¥ˆ, à¤•à¥à¤¯à¤¾ à¤ªà¤¤à¤¾ à¤•à¤¬ à¤–à¥à¤²à¥‡à¤—à¤¾?": "There's a lot of traffic here, who knows when it will clear?",
                "Accident dekhi hai maine, bahut bura lag raha": "I saw the accident, it looks really bad"
            };

            // Initial chat messages to demonstrate the platform
            const initialMessages = [
                {
                    sender: 'TrafficBot',
                    text: 'Welcome to Ring Road jam chat! 12 drivers are currently in this 1km zone.',
                    type: 'system',
                    timestamp: '2:47 PM'
                },
                {
                    sender: 'Amit Kumar',
                    text: 'Been stuck here for 25 minutes now... can see ambulance lights ahead. Anyone know what happened?',
                    type: 'other',
                    timestamp: '2:48 PM'
                },
                {
                    sender: 'Priya Sharma',
                    text: 'I can see the accident site clearly. Truck crashed into two cars. Please keep left lane clear for emergency vehicles!',
                    type: 'helper',
                    timestamp: '2:49 PM',
                    hasImage: true
                },
                {
                    sender: 'RahulDriver',
                    text: 'à¤¯à¤¹à¤¾à¤ à¤¬à¤¹à¥à¤¤ à¤œà¤¾à¤® à¤¹à¥ˆ, à¤•à¥à¤¯à¤¾ à¤ªà¤¤à¤¾ à¤•à¤¬ à¤–à¥à¤²à¥‡à¤—à¤¾?',
                    type: 'other',
                    timestamp: '2:50 PM',
                    translatable: true
                },
                {
                    sender: 'SarahM',
                    text: 'Thanks Priya for the update! Taking alternate route via Outer Ring Road.',
                    type: 'other',
                    timestamp: '2:51 PM'
                }
            ];

            // Function to display a message in the chat
            function displayMessage(msg) {
                const messageEl = document.createElement('div');
                messageEl.classList.add('message', msg.type);

                if (msg.type === 'system') {
                    messageEl.innerHTML = `
                        <div class="system-message">
                            <p><strong>ðŸ¤– ${msg.sender}:</strong> ${msg.text}</p>
                        </div>
                    `;
                } else {
                    const senderEl = document.createElement('div');
                    senderEl.classList.add('message-sender');
                    senderEl.innerHTML = `${msg.sender} <span style="color: #94a3b8; font-weight: normal;">${msg.timestamp || ''}</span>`;

                    if (msg.type === 'helper') {
                        senderEl.innerHTML += ` <i class="fas fa-check-circle verified-badge" title="Verified Helper"></i>`;
                    }

                    const bubbleEl = document.createElement('div');
                    bubbleEl.classList.add('message-bubble');
                    
                    const textEl = document.createElement('span');
                    textEl.textContent = msg.text;
                    bubbleEl.appendChild(textEl);

                    // Add image placeholder for verified helpers
                    if (msg.hasImage) {
                        const imgPlaceholder = document.createElement('div');
                        imgPlaceholder.classList.add('image-placeholder');
                        imgPlaceholder.innerHTML = `
                            <i class="fas fa-camera"></i><br>
                            ðŸ“¸ Accident scene photo - Heavy damage visible<br>
                            <small>Verified image â€¢ Safe for work</small>
                        `;
                        bubbleEl.appendChild(imgPlaceholder);
                    }

                    messageEl.appendChild(senderEl);
                    messageEl.appendChild(bubbleEl);

                    // Add translation button for translatable messages
                    if (msg.translatable) {
                        const translateBtn = document.createElement('button');
                        translateBtn.classList.add('translate-btn');
                        translateBtn.textContent = 'ðŸŒ Translate';
                        let isTranslated = false;
                        
                        translateBtn.onclick = () => {
                            if (isTranslated) {
                                textEl.textContent = msg.text;
                                translateBtn.textContent = 'ðŸŒ Translate';
                            } else {
                                textEl.textContent = translations[msg.text] || "Translation not available";
                                translateBtn.textContent = 'ðŸ”„ Show Original';
                            }
                            isTranslated = !isTranslated;
                        };
                        messageEl.appendChild(translateBtn);
                    }
                }

                chatWindow.appendChild(messageEl);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }

            // Function to send a message
            function sendMessage() {
                const text = messageInput.value.trim();
                if (text === '') return;

                // Check for inappropriate content
                const hasInappropriateContent = inappropriateWords.some(word => 
                    text.toLowerCase().includes(word.toLowerCase())
                );

                if (hasInappropriateContent) {
                    showModal('Message Blocked by AI ðŸ¤–', 
                        'Your message contains inappropriate language and was not sent. Our AI promotes respectful communication in traffic situations. Please rephrase your message.');
                    messageInput.value = '';
                    return;
                }

                // Add user message
                const userMsg = {
                    sender: 'You',
                    text: text,
                    type: 'user',
                    timestamp: new Date().toLocaleTimeString('en-US', {
                        hour: 'numeric',
                        minute: '2-digit',
                        hour12: true
                    })
                };
                displayMessage(userMsg);

                // Clear input and auto-responses
                messageInput.value = '';
                
                // Simulate community response after user message
                setTimeout(() => {
                    const responses = [
                        {
                            sender: 'Local Helper',
                            text: 'Thanks for the update! Situation is slowly improving here.',
                            type: 'helper',
                            timestamp: new Date().toLocaleTimeString('en-US', {
                                hour: 'numeric',
                                minute: '2-digit',
                                hour12: true
                            })
                        },
                        {
                            sender: 'TrafficBot',
                            text: 'ðŸš¨ Update: Emergency vehicles have cleared the scene. Traffic should resume normal flow in 8-10 minutes.',
                            type: 'system'
                        }
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    displayMessage(randomResponse);
                }, 2000);
            }

            // Event listeners for chat
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Load initial messages
            initialMessages.forEach((msg, index) => {
                setTimeout(() => displayMessage(msg), index * 500);
            });

            // --- NAVIGATION AND UI ---
            const hamburger = document.querySelector('.hamburger-menu');
            const mobileNav = document.querySelector('.mobile-nav');
            const closeBtn = document.querySelector('.close-btn');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav .nav-links a');

            hamburger?.addEventListener('click', (e) => {
                e.preventDefault();
                mobileNav?.classList.add('is-open');
                document.body.style.overflow = 'hidden'; // Prevent background scrolling
            });
            
            closeBtn?.addEventListener('click', () => {
                mobileNav?.classList.remove('is-open');
                document.body.style.overflow = 'auto'; // Restore scrolling
            });
            
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileNav?.classList.remove('is-open');
                    document.body.style.overflow = 'auto'; // Restore scrolling
                });
            });
            
            // Close mobile menu when clicking outside
            mobileNav?.addEventListener('click', (e) => {
                if (e.target === mobileNav) {
                    mobileNav.classList.remove('is-open');
                    document.body.style.overflow = 'auto';
                }
            });

            // --- MODAL FUNCTIONALITY ---
            const modal = document.getElementById('alertModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalClose = document.getElementById('modalClose');

            function showModal(title, message) {
                modalTitle.textContent = title;
                modalMessage.textContent = message;
                modal.classList.add('show');
            }

            modalClose.addEventListener('click', () => modal.classList.remove('show'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) modal.classList.remove('show');
            });

            // --- FORMSPREE CONTACT FORM INTEGRATION ---
            document.getElementById('contactForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const form = e.target;
                const formData = new FormData(form);
                const submitBtn = document.getElementById('submitBtn');
                const btnText = submitBtn.querySelector('.btn-text');
                const btnLoading = submitBtn.querySelector('.btn-loading');
                const formMessages = document.getElementById('formMessages');
                
                // Show loading state
                submitBtn.disabled = true;
                btnText.style.display = 'none';
                btnLoading.style.display = 'inline';
                formMessages.innerHTML = '';
                
                try {
                    // Submit to Formspree
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (response.ok) {
                        // Success
                        formMessages.innerHTML = `
                            <div style="padding: 15px; background: #d1fae5; border: 1px solid #10b981; border-radius: 8px; color: #065f46;">
                                <i class="fas fa-check-circle" style="color: #10b981; margin-right: 8px;"></i>
                                <strong>Message sent successfully!</strong><br>
                                Thank you for your interest in our Smart Traffic Platform! We'll get back to you within 24 hours.
                            </div>
                        `;
                        form.reset();
                        
                        // Also show modal for better UX
                        showModal('Message Sent! ðŸ“§', 
                            'Thank you for your interest in our Smart Traffic Platform! Our team will review your message and get back to you within 24 hours.');
                    } else {
                        // Handle server errors
                        const data = await response.json();
                        throw new Error(data.errors ? data.errors.map(e => e.message).join(', ') : 'Server error');
                    }
                } catch (error) {
                    // Handle network or other errors
                    console.error('Form submission error:', error);
                    formMessages.innerHTML = `
                        <div style="padding: 15px; background: #fee2e2; border: 1px solid #ef4444; border-radius: 8px; color: #991b1b;">
                            <i class="fas fa-exclamation-triangle" style="color: #ef4444; margin-right: 8px;"></i>
                            <strong>Error sending message:</strong><br>
                            ${error.message || 'Please check your internet connection and try again.'}
                        </div>
                    `;
                } finally {
                    // Reset button state
                    submitBtn.disabled = false;
                    btnText.style.display = 'inline';
                    btnLoading.style.display = 'none';
                }
            });

            // --- SCROLL ANIMATIONS ---
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            // Observe elements for animations
            document.querySelectorAll('.feature-card, .solution-card, .user-category, .impact-card, .stat-card').forEach(el => {
                el.classList.add('animate-in');
                observer.observe(el);
            });

            // --- INTERACTIVE MAP WITH LEAFLET ---
            initializeMap();

            // --- AUTHENTICATION SYSTEM ---
            initializeAuth();

            // --- MAP CONTROLS ---
            initializeMapControls();

            // --- DASHBOARD SYSTEM ---
            initializeDashboard();
        });

        // Initialize Hero Map
        async function initializeHeroMap() {
            try {
                if (typeof L === 'undefined') {
                    console.log('Leaflet not loaded for hero map');
                    return;
                }

                const heroMapElement = document.getElementById('hero-map');
                if (!heroMapElement) return;

                heroMap = L.map('hero-map', {
                    center: [28.6139, 77.2090],
                    zoom: 11,
                    zoomControl: true,
                    scrollWheelZoom: true,
                    touchZoom: true,
                    doubleClickZoom: true,
                    boxZoom: true,
                    keyboard: true,
                    dragging: true
                });

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 18
                }).addTo(heroMap);

                // Load real incidents from backend
                await loadIncidents();
                
                // Add incident markers to hero map
                incidents.forEach(incident => {
                    const color = getIncidentColor(incident.severity);
                    const marker = L.circleMarker([incident.lat, incident.lng], {
                        color: color,
                        fillColor: color,
                        fillOpacity: 0.8,
                        radius: getIncidentRadius(incident.severity)
                    }).addTo(heroMap);
                    
                    // Add popup
                    const popupContent = `
                        <div class="incident-popup">
                            <h4>ðŸš¨ ${incident.type.toUpperCase()} - ${incident.severity.toUpperCase()}</h4>
                            <p><strong>Location:</strong> ${incident.location}</p>
                            <p><strong>Description:</strong> ${incident.description}</p>
                            <p><strong>Reported by:</strong> ${incident.reportedBy}</p>
                            <p><strong>Time:</strong> ${incident.timestamp}</p>
                            ${incident.chatRoomActive ? 
                                '<button class="join-chat-btn" onclick="joinChatRoom(' + incident.id + ')">Join Local Chat</button>' :
                                '<p style="color: #6b7280; font-size: 0.8rem;">Chat room closed</p>'
                            }
                        </div>
                    `;
                    marker.bindPopup(popupContent);
                    
                    // Store reference
                    marker.incidentId = incident.id;
                });
                
                // Initialize hero map controls
                initializeHeroMapControls();
                
                // Update login prompt visibility
                updateLoginPromptVisibility();

            } catch (error) {
                console.error('Error initializing hero map:', error);
            }
        }
        
        // Initialize Hero Map Controls
        function initializeHeroMapControls() {
            const heroToggleTraffic = document.getElementById('heroToggleTraffic');
            const heroReportIncident = document.getElementById('heroReportIncident');
            const heroFindChats = document.getElementById('heroFindChats');
            
            if (heroToggleTraffic) {
                heroToggleTraffic.addEventListener('click', () => {
                    heroToggleTraffic.classList.toggle('active');
                    if (heroToggleTraffic.classList.contains('active')) {
                        // Add simulated traffic layer
                        addTrafficLayer(heroMap);
                        showModal('Traffic Layer Enabled ðŸš¦', 'Now showing real-time traffic conditions on the map.');
                    } else {
                        // Remove traffic layer
                        removeTrafficLayer(heroMap);
                        showModal('Traffic Layer Disabled', 'Traffic layer has been hidden.');
                    }
                });
            }
            
            if (heroReportIncident) {
                heroReportIncident.addEventListener('click', () => {
                    if (!currentUser) {
                        showModal('Login Required ðŸ”’', 'Please login to report traffic incidents.');
                        showAuthModal('login');
                        return;
                    }
                    document.getElementById('reportModal').classList.add('show');
                });
            }
            
            if (heroFindChats) {
                heroFindChats.addEventListener('click', () => {
                    const activeChatrooms = incidents.filter(i => i.chatRoomActive);
                    if (activeChatrooms.length > 0) {
                        showModal('Active Chatrooms Found ðŸ’¬', 
                            `Found ${activeChatrooms.length} active chatrooms. Click on incident markers to join conversations!`);
                    } else {
                        showModal('No Active Chatrooms', 'No active chatrooms in the area right now.');
                    }
                });
            }
        }
        
        // Update login prompt visibility
        function updateLoginPromptVisibility() {
            const loginPrompt = document.getElementById('loginPrompt');
            if (loginPrompt) {
                if (currentUser) {
                    loginPrompt.style.display = 'none';
                } else {
                    loginPrompt.style.display = 'block';
                    
                    // Add event listeners
                    const promptLoginBtn = document.getElementById('promptLoginBtn');
                    const promptSignupBtn = document.getElementById('promptSignupBtn');
                    
                    if (promptLoginBtn) {
                        promptLoginBtn.addEventListener('click', () => showAuthModal('login'));
                    }
                    if (promptSignupBtn) {
                        promptSignupBtn.addEventListener('click', () => showAuthModal('signup'));
                    }
                }
            }
        }
        
        // Initialize Interactive Map with Leaflet
        function initializeMap() {
            try {
                // Check if Leaflet is loaded
                if (typeof L === 'undefined') {
                    console.error('Leaflet library not loaded');
                    showMapFallback();
                    return;
                }

                // Initialize the map with better error handling
                const mapElement = document.getElementById('map');
                if (!mapElement) {
                    console.error('Map element not found');
                    return;
                }

                map = L.map('map', {
                    center: [28.6139, 77.2090],
                    zoom: 12,
                    zoomControl: true,
                    scrollWheelZoom: true,
                    touchZoom: true,
                    doubleClickZoom: true,
                    boxZoom: true,
                    keyboard: true,
                    dragging: true
                });

                // Add OpenStreetMap tiles with error handling
                const tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 18,
                    errorTileUrl: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmOGZmIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzJlNjNlYiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk1hcCBUaWxlPC90ZXh0Pjwvc3ZnPg=='
                });

                tileLayer.addTo(map);

                // Wait for map to be ready
                map.whenReady(async () => {
                    console.log('Map initialized successfully');
                    
                    // Load incidents from backend
                    await loadIncidents();
                    
                    // Add incident markers
                    incidents.forEach(incident => {
                        addIncidentToMap(incident);
                    });
                    
                    // Force map to invalidate size to ensure proper display
                    setTimeout(() => {
                        map.invalidateSize();
                    }, 250);
                });

                // Add click listener for reporting new incidents
                map.on('click', function(e) {
                    if (currentUser) {
                        const reportModal = document.getElementById('reportModal');
                        if (reportModal) {
                            reportModal.classList.add('show');
                            
                            // Store clicked coordinates
                            window.tempIncidentCoords = e.latlng;
                            
                            // Pre-fill location if possible
                            const locationInput = document.getElementById('incidentLocation');
                            if (locationInput) {
                                const lat = e.latlng.lat.toFixed(4);
                                const lng = e.latlng.lng.toFixed(4);
                                locationInput.placeholder = `Clicked location: ${lat}, ${lng}`;
                            }
                            
                            showModal('ðŸ“ Location Selected', 
                                `You've selected coordinates ${e.latlng.lat.toFixed(4)}, ${e.latlng.lng.toFixed(4)}. Please fill in the incident details.`);
                        }
                    } else {
                        showModal('Login Required ðŸ”’', 
                            'Please login to report incidents. Click a marker to join existing chatrooms without logging in.');
                    }
                });

            } catch (error) {
                console.error('Error initializing map:', error);
                showMapFallback();
            }
        }

        function addIncidentToMap(incident) {
            if (!map) return;
            
            const markerColor = getIncidentColor(incident.severity);
            const marker = L.circleMarker([incident.lat, incident.lng], {
                color: markerColor,
                fillColor: markerColor,
                fillOpacity: 0.8,
                radius: getIncidentRadius(incident.severity)
            }).addTo(map);

            // Create popup content
            const popupContent = `
                <div class="incident-popup">
                    <h4>ðŸš¨ ${incident.type.toUpperCase()} - ${incident.severity.toUpperCase()}</h4>
                    <p><strong>Location:</strong> ${incident.location}</p>
                    <p><strong>Description:</strong> ${incident.description}</p>
                    <p><strong>Reported by:</strong> ${incident.reportedBy}</p>
                    <p><strong>Time:</strong> ${incident.timestamp}</p>
                    ${incident.chatRoomActive ? 
                        '<button class="join-chat-btn" onclick="joinChatRoom(' + incident.id + ')">Join Local Chat</button>' :
                        '<p style="color: #6b7280; font-size: 0.8rem;">Chat room closed</p>'
                    }
                </div>
            `;

            marker.bindPopup(popupContent);
            
            // Store reference for potential removal
            marker.incidentId = incident.id;
        }
        
        function showMapFallback() {
            const mapElement = document.getElementById('map');
            if (mapElement) {
                mapElement.innerHTML = `
                    <div style="height: 100%; display: flex; align-items: center; justify-content: center; background: var(--light-blue-bg); flex-direction: column; text-align: center; padding: 40px; border-radius: 12px;">
                        <i class="fas fa-map-marked-alt" style="font-size: 4rem; color: var(--primary); margin-bottom: 30px;"></i>
                        <h3 style="color: var(--dark); margin-bottom: 20px; font-size: 1.5rem;">Interactive Traffic Map</h3>
                        <p style="color: var(--text-gray); margin-bottom: 25px; max-width: 400px;">Real-time traffic incidents and AI-powered insights will be displayed here once the map loads.</p>
                        
                        <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 450px;">
                            <h4 style="margin: 0 0 15px 0; color: var(--primary);">Demo Features Available:</h4>
                            <div style="text-align: left;">
                                <p style="margin: 8px 0; font-size: 0.95rem;"><i class="fas fa-circle" style="color: #dc2626; margin-right: 8px;"></i> Critical incidents (Red markers)</p>
                                <p style="margin: 8px 0; font-size: 0.95rem;"><i class="fas fa-circle" style="color: #ea580c; margin-right: 8px;"></i> High priority incidents (Orange)</p>
                                <p style="margin: 8px 0; font-size: 0.95rem;"><i class="fas fa-circle" style="color: #d97706; margin-right: 8px;"></i> Medium priority incidents (Yellow)</p>
                                <p style="margin: 8px 0; font-size: 0.95rem;"><i class="fas fa-circle" style="color: #65a30d; margin-right: 8px;"></i> Low priority incidents (Green)</p>
                            </div>
                            <p style="margin: 15px 0 0 0; font-size: 0.9rem; color: var(--text-muted); font-style: italic;">Click incidents to join local chatrooms â€¢ Report new incidents â€¢ Toggle traffic layers</p>
                        </div>
                        
                        <button onclick="location.reload()" class="btn btn-primary" style="margin-top: 25px; padding: 12px 25px;">
                            <i class="fas fa-refresh"></i> Reload Map
                        </button>
                    </div>
                `;
            }
        }
        
        function displayRealTimeMessage(data) {
            // This function handles real-time chat messages from Socket.IO
            // Implementation depends on which chatroom is currently active
            console.log('Real-time message received:', data);
        }
        

        function getIncidentColor(severity) {
            switch(severity) {
                case 'critical': return '#dc2626';
                case 'high': return '#ea580c';
                case 'medium': return '#d97706';
                case 'low': return '#65a30d';
                default: return '#6b7280';
            }
        }

        function getIncidentRadius(severity) {
            switch(severity) {
                case 'critical': return 15;
                case 'high': return 12;
                case 'medium': return 9;
                case 'low': return 6;
                default: return 6;
            }
        }

        function joinChatRoom(incidentId) {
            if (!currentUser) {
                showModal('Login Required ðŸ”’', 'Please login to join traffic chatrooms and communicate with nearby drivers.');
                showAuthModal('login');
                return;
            }

            const incident = incidents.find(i => i.id === incidentId);
            if (!incident) {
                showModal('Chatroom Not Found', 'This incident chatroom is no longer available.');
                return;
            }
            
            if (!incident.chatRoomActive) {
                showModal('Chatroom Closed', 'This incident chatroom has been closed as the situation has been resolved.');
                return;
            }
            
            // Use the same logic as joining from chatroom grid
            joinChatroomFromGrid(incidentId);
            
            // Show success message
            showModal('Joined Chatroom! ðŸ’¬', 
                `Welcome to the ${incident.location} chatroom! You can now chat with nearby drivers about this ${incident.type}.`);
        }

        // Authentication System
        function initializeAuth() {
            const authModal = document.getElementById('authModal');
            const loginBtn = document.getElementById('loginBtn');
            const signupBtn = document.getElementById('signupBtn');
            const mobileLoginBtn = document.getElementById('mobileLoginBtn');
            const mobileSignupBtn = document.getElementById('mobileSignupBtn');
            const authClose = document.getElementById('authClose');
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');

            // Event listeners for opening auth modal
            [loginBtn, mobileLoginBtn].forEach(btn => {
                if (btn) {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        showAuthModal('login');
                    });
                }
            });

            [signupBtn, mobileSignupBtn].forEach(btn => {
                if (btn) {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        showAuthModal('signup');
                    });
                }
            });

            // Close modal
            authClose.addEventListener('click', () => {
                authModal.classList.remove('show');
            });

            // Tab switching
            loginTab.addEventListener('click', () => switchAuthTab('login'));
            signupTab.addEventListener('click', () => switchAuthTab('signup'));

            // Form submissions
            loginForm.addEventListener('submit', handleLogin);
            signupForm.addEventListener('submit', handleSignup);
            
            // Quick login buttons
            document.querySelectorAll('.quick-login-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const email = btn.dataset.email;
                    const password = btn.dataset.password;
                    const userType = btn.dataset.type;
                    
                    // Fill in the form
                    document.getElementById('loginEmail').value = email;
                    document.getElementById('loginPassword').value = password;
                    document.getElementById('loginUserType').value = userType;
                    
                    // Trigger login
                    setTimeout(() => {
                        loginForm.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
                    }, 100);
                });
            });

            // User menu functionality
            const userAvatar = document.getElementById('userAvatar');
            const dropdownContent = document.getElementById('dropdownContent');
            const logoutBtn = document.getElementById('logoutBtn');
            const userMenu = document.getElementById('userMenu');

            if (userAvatar && dropdownContent) {
                // Improved click handling for desktop browsers
                userAvatar.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('User avatar clicked'); // Debug log
                    
                    // Toggle dropdown with better state management
                    const isShown = dropdownContent.classList.contains('show');
                    if (isShown) {
                        dropdownContent.classList.remove('show');
                        console.log('Dropdown hidden');
                    } else {
                        dropdownContent.classList.add('show');
                        console.log('Dropdown shown');
                    }
                });
                
                // Also handle keydown for accessibility
                userAvatar.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        userAvatar.click();
                    }
                });

                // Improved click outside logic
                document.addEventListener('click', (e) => {
                    if (userMenu && !userMenu.contains(e.target)) {
                        if (dropdownContent.classList.contains('show')) {
                            console.log('Clicking outside - hiding dropdown');
                            dropdownContent.classList.remove('show');
                        }
                    }
                });
                
                // Close dropdown on escape key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && dropdownContent.classList.contains('show')) {
                        dropdownContent.classList.remove('show');
                        userAvatar.focus();
                    }
                });
            }

            if (logoutBtn) {
                logoutBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Logout button clicked'); // Debug log
                    
                    // Close dropdown first
                    const dropdownContent = document.getElementById('dropdownContent');
                    if (dropdownContent) {
                        dropdownContent.classList.remove('show');
                    }
                    
                    // Show confirmation and logout
                    setTimeout(() => {
                        const shouldLogout = confirm('Are you sure you want to logout?');
                        console.log('Logout confirmation:', shouldLogout);
                        
                        if (shouldLogout) {
                            handleLogout();
                        }
                    }, 100);
                });
                
                // Also handle keydown for accessibility
                logoutBtn.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        logoutBtn.click();
                    }
                });
            }
            
            // Mobile logout button
            const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
            if (mobileLogoutBtn) {
                mobileLogoutBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    handleLogout();
                    // Close mobile menu
                    const mobileNav = document.querySelector('.mobile-nav');
                    if (mobileNav) {
                        mobileNav.classList.remove('is-open');
                    }
                });
            }

            // Add keyboard shortcut for logout (Ctrl+L)
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key.toLowerCase() === 'l' && currentUser) {
                    e.preventDefault();
                    console.log('Keyboard logout shortcut activated');
                    if (confirm('Logout using keyboard shortcut (Ctrl+L)?')) {
                        handleLogout();
                    }
                }
            });
            
            // Add double-click logout fallback on user avatar
            if (userAvatar) {
                let lastClickTime = 0;
                userAvatar.addEventListener('dblclick', (e) => {
                    e.preventDefault();
                    console.log('Double-click logout fallback activated');
                    if (currentUser && confirm('Quick logout with double-click?')) {
                        handleLogout();
                    }
                });
            }

            // Check if user is already logged in
            const savedUser = localStorage.getItem('currentUser');
            const savedToken = localStorage.getItem('authToken');
            if (savedUser && savedToken) {
                currentUser = JSON.parse(savedUser);
                authToken = savedToken;
                updateUIForLoggedInUser();
            }
        }

        function showAuthModal(tab = 'login') {
            const authModal = document.getElementById('authModal');
            if (authModal) {
                authModal.classList.add('show');
                switchAuthTab(tab);
                
                // Focus first input after modal opens
                setTimeout(() => {
                    if (tab === 'login') {
                        const emailInput = document.getElementById('loginEmail');
                        if (emailInput) emailInput.focus();
                    } else {
                        const nameInput = document.getElementById('signupName');
                        if (nameInput) nameInput.focus();
                    }
                }, 300);
            } else {
                console.error('Auth modal not found');
            }
        }

        function switchAuthTab(tab) {
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');

            if (tab === 'login') {
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
                loginForm.classList.add('active');
                signupForm.classList.remove('active');
            } else {
                signupTab.classList.add('active');
                loginTab.classList.remove('active');
                signupForm.classList.add('active');
                loginForm.classList.remove('active');
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const userType = document.getElementById('loginUserType').value;

            if (!email || !password || !userType) {
                showModal('Login Failed', 'Please fill in all fields.');
                return;
            }
            
            // Demo authentication - check against demo credentials
            const demoCredentials = {
                'user@demo.com': { password: 'user123', type: 'user', name: 'John Doe' },
                'helper@demo.com': { password: 'helper123', type: 'helper', name: 'Sarah Helper' },
                'admin@demo.com': { password: 'admin123', type: 'admin', name: 'Admin User' }
            };
            
            const userCredentials = demoCredentials[email.toLowerCase()];
            
            if (!userCredentials || userCredentials.password !== password) {
                showModal('Login Failed', 'Invalid email or password. Please try the demo credentials shown above.');
                return;
            }
            
            // Check if user type matches
            if (userCredentials.type !== userType) {
                showModal('Login Failed', `This account is registered as a ${userCredentials.type}. Please select the correct account type.`);
                return;
            }
            
            // Simulate successful login
            currentUser = {
                id: Math.random().toString(36).substr(2, 9),
                name: userCredentials.name,
                email: email,
                type: userCredentials.type
            };
            authToken = 'demo-token-' + Math.random().toString(36).substr(2, 9);
            
            // Store authentication data
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            localStorage.setItem('authToken', authToken);
            
            updateUIForLoggedInUser();
            showPostLoginExperience();
            
            document.getElementById('authModal').classList.remove('show');
            document.getElementById('loginForm').reset();
        }

        async function handleSignup(e) {
            e.preventDefault();
            
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const phone = document.getElementById('signupPhone').value;
            const password = document.getElementById('signupPassword').value;
            const userType = document.getElementById('signupUserType').value;

            if (!name || !email || !phone || !password || !userType) {
                showModal('Signup Failed', 'Please fill in all fields.');
                return;
            }
            
            // Simulate successful signup for demo
            currentUser = {
                id: Math.random().toString(36).substr(2, 9),
                name: name,
                email: email,
                phone: phone,
                type: userType
            };
            authToken = 'demo-token-' + Math.random().toString(36).substr(2, 9);
            
            
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            localStorage.setItem('authToken', authToken);
            
            updateUIForLoggedInUser();
            showPostLoginExperience();
            
            document.getElementById('authModal').classList.remove('show');
            document.getElementById('signupForm').reset();
            
            showModal('ðŸŽ‰ Account Created!', 
                `Welcome ${name}! Your ${userType} account has been created successfully. You can now access all platform features.`);
        }

        function updateUIForLoggedInUser() {
            const authButtons = document.querySelector('.auth-buttons');
            const userMenu = document.getElementById('userMenu');
            const userName = document.getElementById('userName');

            if (authButtons && userMenu && userName) {
                authButtons.style.display = 'none';
                userMenu.style.display = 'block';
                userName.textContent = currentUser.name;
                
                const userAvatar = document.getElementById('userAvatar');
                const logoutHint = ' <small style="opacity: 0.7; font-size: 0.7rem;">(Click â†“ or Double-Click to logout)</small>';
                
                if (currentUser.type === 'admin') {
                    userAvatar.innerHTML = '<i class="fas fa-user-shield"></i> <span>' + currentUser.name + '</span><i class="fas fa-chevron-down" style="margin-left: 5px; font-size: 0.8rem;"></i>';
                } else if (currentUser.type === 'helper') {
                    userAvatar.innerHTML = '<i class="fas fa-user-check"></i> <span>' + currentUser.name + '</span><i class="fas fa-chevron-down" style="margin-left: 5px; font-size: 0.8rem;"></i>';
                } else {
                    userAvatar.innerHTML = '<i class="fas fa-user-circle"></i> <span>' + currentUser.name + '</span><i class="fas fa-chevron-down" style="margin-left: 5px; font-size: 0.8rem;"></i>';
                }
               
                userAvatar.setAttribute('title', 'Click to open menu â€¢ Double-click to logout â€¢ Ctrl+L for quick logout');
        
                console.log('User logged in:', currentUser);
                console.log('User avatar updated:', userAvatar);
                console.log('Dropdown element:', document.getElementById('dropdownContent'));
           
                const dropdownUserName = document.getElementById('dropdownUserName');
                const dropdownUserType = document.getElementById('dropdownUserType');
                
                if (dropdownUserName) dropdownUserName.textContent = currentUser.name;
                if (dropdownUserType) {
                    const typeLabels = {
                        'user': 'Regular User',
                        'helper': 'Verified Helper', 
                        'admin': 'Administrator'
                    };
                    dropdownUserType.textContent = typeLabels[currentUser.type] || currentUser.type;
                }
            }
       
            const mobileAuthButtons = document.getElementById('mobileAuthButtons');
            const mobileUserMenu = document.getElementById('mobileUserMenu');
            const mobileUserName = document.getElementById('mobileUserName');
            const mobileUserType = document.getElementById('mobileUserType');
            
            if (mobileAuthButtons && mobileUserMenu) {
                mobileAuthButtons.style.display = 'none';
                mobileUserMenu.style.display = 'block';
                
                if (mobileUserName) mobileUserName.textContent = currentUser.name;
                if (mobileUserType) {
                    const typeLabels = {
                        'user': 'Regular User',
                        'helper': 'Verified Helper', 
                        'admin': 'Administrator'
                    };
                    mobileUserType.textContent = typeLabels[currentUser.type] || currentUser.type;
                }
            }
            
  
            const loginPrompt = document.getElementById('loginPrompt');
            const welcomeMessage = document.getElementById('welcomeMessage');
            
            if (loginPrompt) loginPrompt.style.display = 'none';
            if (welcomeMessage) welcomeMessage.style.display = 'block';
        }

        function handleLogout() {
            currentUser = null;
            authToken = null;
            localStorage.removeItem('currentUser');
            localStorage.removeItem('authToken');
            
            const authButtons = document.querySelector('.auth-buttons');
            const userMenu = document.getElementById('userMenu');
            const mobileAuthButtons = document.getElementById('mobileAuthButtons');
            const mobileUserMenu = document.getElementById('mobileUserMenu');
            
            if (authButtons && userMenu) {
                authButtons.style.display = 'flex';
                userMenu.style.display = 'none';
            }
            
            if (mobileAuthButtons && mobileUserMenu) {
                mobileAuthButtons.style.display = 'block';
                mobileUserMenu.style.display = 'none';
            }
          
            const loginPrompt = document.getElementById('loginPrompt');
            const welcomeMessage = document.getElementById('welcomeMessage');
            
            if (loginPrompt) loginPrompt.style.display = 'block';
            if (welcomeMessage) welcomeMessage.style.display = 'none';
            
        
            const activeChatContainer = document.getElementById('activeChatContainer');
            if (activeChatContainer) {
                activeChatContainer.style.display = 'none';
            }
      
            const dashboard = document.getElementById('dashboard');
            if (dashboard) {
                dashboard.classList.remove('show');
            }
            
            
            const reportModal = document.getElementById('reportModal');
            if (reportModal) {
                reportModal.classList.remove('show');
            }
            
          
            const dropdownContent = document.getElementById('dropdownContent');
            if (dropdownContent) {
                dropdownContent.classList.remove('show');
            }
       
            if (socket && socket.connected) {
                socket.disconnect();
            }
            
            showModal('Logged Out Successfully! ðŸ‘‹', 'You have been successfully logged out. Thank you for using our smart traffic platform!');
            
         
            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 1000);
        }

   
        function initializeMapControls() {
            const toggleTrafficBtn = document.getElementById('toggleTraffic');
            const reportIncidentBtn = document.getElementById('reportIncident');
            const findChatroomsBtn = document.getElementById('findChatrooms');
            const reportModal = document.getElementById('reportModal');
            const reportClose = document.getElementById('reportClose');
            const reportForm = document.getElementById('reportForm');

            if (toggleTrafficBtn) {
                toggleTrafficBtn.addEventListener('click', () => {
                    toggleTrafficBtn.classList.toggle('active');
                    if (toggleTrafficBtn.classList.contains('active')) {
                       
                        addTrafficLayer(map);
                        showModal('Traffic Layer Enabled ðŸš¦', 'Now showing real-time traffic conditions on the map.');
                    } else {
                      
                        removeTrafficLayer(map);
                        showModal('Traffic Layer Disabled', 'Traffic layer has been hidden.');
                    }
                });
            }

            if (reportIncidentBtn) {
                reportIncidentBtn.addEventListener('click', () => {
                    if (!currentUser) {
                        showModal('Login Required ðŸ”’', 'Please login to report traffic incidents.');
                        showAuthModal('login');
                        return;
                    }
                    if (reportModal) {
                        reportModal.classList.add('show');
                        showModal('ðŸ“ Report New Incident', 'Click anywhere on the map to set location, or fill in the location field manually. Your report will create a chatroom for other drivers.');
                    } else {
                        showModal('Error', 'Report modal not found. Please refresh the page.');
                    }
                });
            }

            if (findChatroomsBtn) {
                findChatroomsBtn.addEventListener('click', () => {
                    const activeChatrooms = incidents.filter(i => i.chatRoomActive);
                    if (activeChatrooms.length > 0) {
                        showModal('Active Chatrooms Found ðŸ’¬', 
                            `Found ${activeChatrooms.length} active chatrooms. Click on red markers to join conversations!`);
                    } else {
                        showModal('No Active Chatrooms', 'No active chatrooms in your area right now.');
                    }
                });
            }

            if (reportClose) {
                reportClose.addEventListener('click', () => {
                    reportModal.classList.remove('show');
                });
            }
            
            // Close modal when clicking outside
            if (reportModal) {
                reportModal.addEventListener('click', (e) => {
                    if (e.target === reportModal) {
                        reportModal.classList.remove('show');
                    }
                });
            }

            if (reportForm) {
                reportForm.addEventListener('submit', handleIncidentReport);
            }
        }

        async function handleIncidentReport(e) {
            e.preventDefault();
            
            const type = document.getElementById('incidentType').value;
            const severity = document.getElementById('incidentSeverity').value;
            const description = document.getElementById('incidentDescription').value;
            const location = document.getElementById('incidentLocation').value;

            if (!type || !severity || !description || !location) {
                showModal('Incomplete Form', 'Please fill in all fields.');
                return;
            }
            
            const lat = window.tempIncidentCoords ? window.tempIncidentCoords.lat : (28.6139 + (Math.random() - 0.5) * 0.1);
            const lng = window.tempIncidentCoords ? window.tempIncidentCoords.lng : (77.2090 + (Math.random() - 0.5) * 0.1);
            
            // Create new incident object
            const newIncident = {
                id: incidents.length + Math.floor(Math.random() * 1000),
                lat: lat,
                lng: lng,
                type: type,
                severity: severity,
                description: description,
                location: location,
                reportedBy: currentUser.name,
                timestamp: new Date().toLocaleTimeString('en-US', {
                    hour: 'numeric',
                    minute: '2-digit',
                    hour12: true
                }),
                chatRoomActive: true,
                resolved: false,
                created_at: new Date().toISOString()
            };
            
            // Add to incidents array
            incidents.push(newIncident);
            
            // Add to map if map is initialized
            if (map) {
                addIncidentToMap(newIncident);
            }
            
            // Close modal and reset form
            document.getElementById('reportModal').classList.remove('show');
            document.getElementById('reportForm').reset();
            
            // Clear temporary coordinates
            window.tempIncidentCoords = null;
            
            showModal('ðŸŽ‰ Incident Reported Successfully!', 
                `Your ${severity} ${type} report for "${location}" has been submitted and is now visible to other drivers. A local chatroom has been automatically created for this incident.`);
            
            // Simulate real-time notification to other users
            setTimeout(() => {
                if (socket && socket.emit) {
                    socket.emit('new-incident', newIncident);
                }
                
                // Update dashboard if open
                const dashboard = document.getElementById('dashboard');
                if (dashboard && dashboard.classList.contains('show')) {
                    showDashboard(); // Refresh dashboard content
                }
                
                // Show success message about chatroom
                setTimeout(() => {
                    showModal('ðŸ’¬ Chatroom Created!', 
                        `A new chatroom has been created for the ${type} at ${location}. Other drivers in the area can now join to share updates and help each other.`);
                }, 2000);
            }, 500);
        }

        function initializeDashboard() {
            const dashboardLink = document.getElementById('dashboardLink');
            const closeDashboard = document.getElementById('closeDashboard');
            const dashboard = document.getElementById('dashboard');

            if (dashboardLink) {
                dashboardLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    showDashboard();
                });
            }

            if (closeDashboard) {
                closeDashboard.addEventListener('click', () => {
                    dashboard.classList.remove('show');
                });
            }
        }

        function showDashboard() {
            if (!currentUser) {
                showModal('Login Required ðŸ”’', 'Please log in or sign up to access your dashboard.');
                showAuthModal('login');
                return;
            }
            
            const dashboard = document.getElementById('dashboard');
            const dashboardTitle = document.getElementById('dashboardTitle');
            const dashboardContent = document.getElementById('dashboardContent');

            dashboardTitle.textContent = `${currentUser.type.charAt(0).toUpperCase() + currentUser.type.slice(1)} Dashboard`;
            
            let content = '';
            
            if (currentUser.type === 'admin') {
                content = getAdminDashboardContent();
            } else {
                content = getUserDashboardContent();
            }
            
            dashboardContent.innerHTML = content;
            dashboard.classList.add('show');
        }

        function getUserDashboardContent() {
            return `
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h4>ðŸ“ˆ Your Activity</h4>
                        <div class="stat-item">
                            <span>Incidents Reported</span>
                            <span class="stat-value">${incidents.filter(i => i.reportedBy === currentUser.name).length}</span>
                        </div>
                        <div class="stat-item">
                            <span>Chatrooms Joined</span>
                            <span class="stat-value">3</span>
                        </div>
                        <div class="stat-item">
                            <span>Account Type</span>
                            <span class="stat-value">${currentUser.type === 'helper' ? 'Verified Helper' : 'Regular User'}</span>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4>ðŸš¨ Active Incidents</h4>
                        <div class="stat-item">
                            <span>Critical</span>
                            <span class="stat-value" style="color: var(--danger)">${incidents.filter(i => i.severity === 'critical').length}</span>
                        </div>
                        <div class="stat-item">
                            <span>High Priority</span>
                            <span class="stat-value" style="color: var(--warning)">${incidents.filter(i => i.severity === 'high').length}</span>
                        </div>
                        <div class="stat-item">
                            <span>Medium Priority</span>
                            <span class="stat-value">${incidents.filter(i => i.severity === 'medium').length}</span>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4>ðŸ’¬ Current Chatrooms</h4>
                        ${incidents.filter(i => i.chatRoomActive).map(incident => `
                            <div class="stat-item">
                                <span>${incident.location}</span>
                                <button class="btn btn-primary" style="padding: 5px 10px; font-size: 0.8rem;" 
                                        onclick="joinChatRoom(${incident.id})">Join</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function getAdminDashboardContent() {
            return `
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h4>ðŸ“ˆ System Overview</h4>
                        <div class="stat-item">
                            <span>Total Incidents</span>
                            <span class="stat-value">${incidents.length}</span>
                        </div>
                        <div class="stat-item">
                            <span>Active Chatrooms</span>
                            <span class="stat-value">${incidents.filter(i => i.chatRoomActive).length}</span>
                        </div>
                        <div class="stat-item">
                            <span>Platform Users</span>
                            <span class="stat-value">1,247</span>
                        </div>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4>ðŸ”§ Admin Controls</h4>
                        <button class="btn btn-primary" style="width: 100%; margin-bottom: 10px;">Manage Incidents</button>
                        <button class="btn btn-secondary" style="width: 100%; margin-bottom: 10px;">User Management</button>
                        <button class="btn btn-secondary" style="width: 100%; margin-bottom: 10px;">System Settings</button>
                        <button class="btn btn-secondary" style="width: 100%;">Generate Reports</button>
                    </div>
                    
                    <div class="dashboard-card">
                        <h4>ðŸš¨ Incident Management</h4>
                        ${incidents.map(incident => `
                            <div class="stat-item">
                                <div>
                                    <strong>${incident.location}</strong><br>
                                    <small>${incident.type} - ${incident.severity}</small>
                                </div>
                                <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;">Resolve</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }
        
        let trafficLayers = new Map();
        
        function addTrafficLayer(mapInstance) {
            if (!mapInstance || trafficLayers.has(mapInstance)) return;
            
            const trafficData = [
               
                { coords: [[28.6139, 77.2090], [28.6500, 77.2100]], color: '#ef4444', weight: 6, opacity: 0.8 },
                { coords: [[28.6542, 77.2373], [28.6304, 77.2177]], color: '#ef4444', weight: 6, opacity: 0.8 },
                { coords: [[28.4817, 77.1873], [28.4595, 77.0266]], color: '#ef4444', weight: 6, opacity: 0.8 },
                
             
                { coords: [[28.6315, 77.2167], [28.6139, 77.2090]], color: '#f59e0b', weight: 5, opacity: 0.7 },
                { coords: [[28.5532, 77.2750], [28.5800, 77.3200]], color: '#f59e0b', weight: 5, opacity: 0.7 },
                { coords: [[28.6700, 77.2300], [28.6667, 77.2167]], color: '#f59e0b', weight: 5, opacity: 0.7 },
                
              
                { coords: [[28.7041, 77.1025], [28.7230, 77.1200]], color: '#22c55e', weight: 4, opacity: 0.6 },
                { coords: [[28.5355, 77.3910], [28.5800, 77.3200]], color: '#22c55e', weight: 4, opacity: 0.6 },
                { coords: [[28.5245, 77.1855], [28.5167, 77.2167]], color: '#22c55e', weight: 4, opacity: 0.6 }
            ];
            
            const trafficLayerGroup = L.layerGroup();
            
            trafficData.forEach(traffic => {
                const line = L.polyline(traffic.coords, {
                    color: traffic.color,
                    weight: traffic.weight,
                    opacity: traffic.opacity
                });
                
                
                const severity = traffic.color === '#ef4444' ? 'Heavy Traffic' : 
                               traffic.color === '#f59e0b' ? 'Moderate Traffic' : 'Light Traffic';
                const speed = traffic.color === '#ef4444' ? '15-25 km/h' : 
                             traffic.color === '#f59e0b' ? '30-45 km/h' : '50-60 km/h';
                
                line.bindPopup(`
                    <div class="traffic-popup">
                        <h4 style="color: ${traffic.color}; margin: 0 0 8px 0;">
                            ðŸš— ${severity}
                        </h4>
                        <p style="margin: 0; font-size: 0.9rem;">
                            <strong>Average Speed:</strong> ${speed}<br>
                            <strong>Status:</strong> ${severity === 'Heavy Traffic' ? 'Congested' : severity === 'Moderate Traffic' ? 'Slow Moving' : 'Free Flowing'}
                        </p>
                    </div>
                `);
                
                trafficLayerGroup.addLayer(line);
            });
            
            trafficLayerGroup.addTo(mapInstance);
            trafficLayers.set(mapInstance, trafficLayerGroup);
        }
        
        function removeTrafficLayer(mapInstance) {
            if (!mapInstance || !trafficLayers.has(mapInstance)) return;
            
            const trafficLayer = trafficLayers.get(mapInstance);
            mapInstance.removeLayer(trafficLayer);
            trafficLayers.delete(mapInstance);
        }
        
       
        function launchRouteWithLocations() {
            const fromLocation = document.getElementById('mainFromLocation').value.trim();
            const toLocation = document.getElementById('mainToLocation').value.trim();
            
            if (!fromLocation || !toLocation) {
                showModal('Incomplete Information', 'Please enter both starting location and destination before launching the route planner.');
                return;
            }
            
         
            const routeData = {
                from: fromLocation,
                to: toLocation,
                timestamp: Date.now()
            };
            
            localStorage.setItem('routePlannerData', JSON.stringify(routeData));

            window.location.href = 'route-planner.html';
        }

        function initializeLocationInputs() {
            const fromInput = document.getElementById('mainFromLocation');
            const toInput = document.getElementById('mainToLocation');
            
            if (!fromInput || !toInput) return;
            
            const popularLocations = [
                'Connaught Place, New Delhi',
                'India Gate, New Delhi', 
                'Red Fort, Delhi',
                'Gurgaon Cyber City',
                'Noida Sector 18',
                'Dwarka Sector 21',
                'Delhi Airport Terminal 3',
                'Karol Bagh Market',
                'Lajpat Nagar Market',
                'Khan Market, Delhi',
                'Chandni Chowk, Delhi',
                'Saket Select City Walk',
                'Hauz Khas Village',
                'Nehru Place, Delhi'
            ];
            [fromInput, toInput].forEach(input => {
                input.addEventListener('focus', () => {
                    if (!input.value) {
                        const randomLocation = popularLocations[Math.floor(Math.random() * popularLocations.length)];
                        input.placeholder = `e.g., ${randomLocation}`;
                    }
                });
                
                input.addEventListener('blur', () => {
                    input.placeholder = input === fromInput ? 'Enter starting location' : 'Enter destination';
                });
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initializeLocationInputs, 500);
        });
    </script>
    
</body>
</html>
